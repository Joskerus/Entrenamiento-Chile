<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Análisis de Brotes y Modelamiento en Salud Pública: Todo en Una Sola Página</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Epiverse-TRACE" src="assets/images/logo_epimodelac.png"><abbr class="badge badge-light" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="background-color: #FF4955; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #FFF">
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
            Pre-Alpha
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Vista de Aprendiz <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Vista de Instructor</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Epiverse-TRACE" src="assets/images/epiverse-logo.svg">
</div>
    <div class="lesson-title-md">
      Análisis de Brotes y Modelamiento en Salud Pública
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Análisis de Brotes y Modelamiento en Salud Pública
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Puntos Clave</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glosario</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Perfiles de Aprendiz</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            Más <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Análisis de Brotes y Modelamiento en Salud Pública
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Vista de Aprendiz
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Vista de Instructor</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODIOS
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <?xml version="1.0" encoding="UTF-8"?><div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
      <a href="index.html">Resumen y Configuración</a>
    </div>
    <!--/div.accordion-header-->
  </div>
  <!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="TallerIntroAnaliticaBrotes.html">1. Taller Día 2 - Introducción a la analítica de brotes</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="ZIKAB.html">2. Taller Día 3 - Construyendo un modelo matemático simple para Zika.</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="EnfermedadX.html">3. Taller Día 4 - Grupo 1 Estimación de las distribuciones de rezagos epidemiológicos: Enfermedad X</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RECURSOS
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Puntos Clave</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glosario</a>
                      </li>
                      <li>
                        <a href="profiles.html">Perfiles de Aprendiz</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">Ver todo en una sola página</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-TallerIntroAnaliticaBrotes"><p>Content from <a href="TallerIntroAnaliticaBrotes.html">Taller Día 2 - Introducción a la analítica de brotes</a></p>
<hr>
<p> Last updated on 2023-12-03 | 
        
        <a href="https://github.com/Joskerus/Nuevoformato/edit/main/episodes/TallerIntroAnaliticaBrotes.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>¿Cómo modelar y analizar un brote?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<p>Al final de este taller usted podrá:</p>
<ul>
<li><p>Identificar los parámetros necesarios en casos de transmisión de
enfermedades infecciosas de persona a persona.</p></li>
<li><p>Estimar la probabilidad de muerte (CFR).</p></li>
<li><p>Calcular y graficar la incidencia.</p></li>
<li><p>Estimar e interpretar la tasa de crecimiento y el tiempo en que
se duplica la epidemia.</p></li>
<li><p>Estimar e interpretar el número de reproducción instantáneo de la
epidemia.</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="tiempos-de-ejecución"><h2 class="section-heading">Tiempos de ejecución<a class="anchor" aria-label="anchor" href="#tiempos-de-ejecuci%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>Explicación del taller (10 minutos)</p>
<p>Realización del taller (100 minutos taller)</p>
<ul>
<li><p>Parte 1: Estructura de datos y CFR (15 min)</p></li>
<li><p>Parte 2: Incidencia y tasa de crecimiento (45 min)</p></li>
<li><p>Parte 3: Rt (40 min)</p></li>
</ul>
<p>Discusión 30 minutos</p>
</section><section id="introducción"><h2 class="section-heading">Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>Un nuevo brote de virus del Ébola (EVE) en un país ficticio de África
occidental</p>
<div class="section level4">
<h4 id="conceptos-básicos-a-desarrollar">Conceptos básicos a desarrollar<a class="anchor" aria-label="anchor" href="#conceptos-b%C3%A1sicos-a-desarrollar"></a>
</h4>
<p>En esta práctica se desarrollarán los siguientes conceptos:</p>
<ul>
<li><p>Transmisión de enfermedades infecciosas de persona a
persona</p></li>
<li><p>Número reproductivo básico</p></li>
<li><p>Número reproductivo efectivo</p></li>
<li><p>Probabilidad de muerte (IFR, CFR)</p></li>
<li><p>Intervalo serial</p></li>
<li><p>Tasa de crecimiento</p></li>
<li><p>Incidencia</p></li>
</ul>
</div>
</section><section id="estructura-de-datos"><h2 class="section-heading">1. Estructura de datos<a class="anchor" aria-label="anchor" href="#estructura-de-datos"></a>
</h2>
<hr class="half-width">
<div class="section level4">
<h4 id="preparación-previa">Preparación previa<a class="anchor" aria-label="anchor" href="#preparaci%C3%B3n-previa"></a>
</h4>
<p>Antes de comenzar, descargue la carpeta con los datos y el proyecto
desde <a href="https://drive.google.com/drive/folders/1T0uZ2FNhwFAnFcCNxfLX8V6Ir3IsJO6y?usp=sharing" class="external-link">Carpetas
de datos</a> . Ahí mismo encontrará un archivo .R para instalar las
dependencias necesarias para este taller.</p>
<p>Recuerde abrir el archivo <code>RProject</code> denominado
<code>Taller-Brotes-Ebola.Rproj</code> antes de empezar a trabajar. Este
paso no solo le ayudará a cumplir con las buenas prácticas de
programación en R, sino también a mantener un directorio organizado,
permitiendo un desarrollo exitoso del taller.</p>
</div>
<div class="section level4">
<h4 id="cargue-de-librerías">Cargue de librerías:<a class="anchor" aria-label="anchor" href="#cargue-de-librer%C3%ADas"></a>
</h4>
<p>Cargue las librerías necesarias para el análisis epidemiológico. Los
datos serán manipulados con tidyverse que es una colección de paquetes
para la ciencia de datos.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span> <span class="co"># contiene ggplot2, dplyr, tidyr, readr, purrr, tibble</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">readxl</span><span class="op">)</span> <span class="co"># para leer archivos Excel</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">binom</span><span class="op">)</span> <span class="co"># para intervalos de confianza binomiales</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">knitr</span><span class="op">)</span> <span class="co"># para crear tablas bonitas con kable()</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">incidence</span><span class="op">)</span> <span class="co"># para calcular incidencia y ajustar modelos</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">EpiEstim</span><span class="op">)</span> <span class="co"># para estimar R(t)</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="cargue-de-bases-de-datos">Cargue de bases de datos<a class="anchor" aria-label="anchor" href="#cargue-de-bases-de-datos"></a>
</h4>
<p>Se le ha proporcionado la siguiente base de datos:</p>
<ul>
<li>
<code>casos</code>: una base de datos de casos que contiene
información de casos hasta el 1 de julio de 2014.</li>
</ul>
<p>Para leer en R este archivo, utilice la función <code>read_rds</code>
de <code>tidyverse</code>. Se creará una tabla de datos almacenada como
objeto de clase <code>tibble.</code></p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">casos</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"files/casos.rds"</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="estructura-de-los-datos">Estructura de los datos<a class="anchor" aria-label="anchor" href="#estructura-de-los-datos"></a>
</h4>
<p>Explore la estructura de los datos. Para esto puede utilizar la
función <code>glimpse</code> de <code>tidyverse</code>, la cual nos
proporciona una visión rápida y legible de la estructura interna de
nuestro conjunto de datos.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">casos</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 166
Columns: 11
$ id_caso                  &lt;chr&gt; "d1fafd", "53371b", "f5c3d8", "6c286a", "0f58…
$ generacion               &lt;dbl&gt; 0, 1, 1, 2, 2, 0, 3, 3, 2, 3, 4, 3, 4, 2, 4, …
$ fecha_de_infeccion       &lt;date&gt; NA, 2014-04-09, 2014-04-18, NA, 2014-04-22, …
$ fecha_inicio_sintomas    &lt;date&gt; 2014-04-07, 2014-04-15, 2014-04-21, 2014-04-…
$ fecha_de_hospitalizacion &lt;date&gt; 2014-04-17, 2014-04-20, 2014-04-25, 2014-04-…
$ fecha_desenlace          &lt;date&gt; 2014-04-19, NA, 2014-04-30, 2014-05-07, 2014…
$ desenlace                &lt;chr&gt; NA, NA, "Recuperacion", "Muerte", "Recuperaci…
$ genero                   &lt;fct&gt; f, m, f, f, f, f, f, f, m, m, f, f, f, f, f, …
$ hospital                 &lt;fct&gt; Military Hospital, Connaught Hospital, other,…
$ longitud                 &lt;dbl&gt; -13.21799, -13.21491, -13.22804, -13.23112, -…
$ latitud                  &lt;dbl&gt; 8.473514, 8.464927, 8.483356, 8.464776, 8.452…</code></pre>
</div>
<p>Como puede observar contactos tiene 11 columnas (variables) y 166
filas de datos. En un rápido vistazo puede observar el tipo de las
variables por ejemplo, la columna <code>desenlace</code> tiene formato
carácter (<code>chr</code>) y contiene entre sus valores
<code>"Recuperación"</code> o <code>"Muerte"</code>.</p>
<p>Además, puede encontrar estas variables:</p>
<ul>
<li><p>El identificador <code>id_caso</code></p></li>
<li><p>La generación de infectados (cuantas infecciones secundarias
desde la fuente hasta el sujeto han ocurrido)</p></li>
<li><p>La fecha de infección</p></li>
<li><p>La fecha de inicio de síntomas</p></li>
<li><p>La fecha de hospitalización</p></li>
<li><p>La fecha del desenlace que, como se puede observar, en la
siguiente variable puede tener entre sus opciones <code>NA</code> (no
hay información hasta ese momento o no hay registro), recuperación y
muerte</p></li>
<li><p>La variable género que puede ser <code>f</code> de femenino o
<code>m</code> de masculino</p></li>
<li><p>El lugar de hospitalización, en la variable hospital</p></li>
<li><p>Y las variables longitud y latitud</p></li>
</ul>
<p>Note que las fechas ya están en formato fecha
(<code>date</code>).</p>
</div>
</section><section id="cfr"><h2 class="section-heading">2. CFR<a class="anchor" aria-label="anchor" href="#cfr"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="probabilidad-de-muerte-en-los-casos-reportados-cfr-por-case-fatality-ratio">Probabilidad de muerte en los casos reportados (<code>CFR</code>,
por <em>Case Fatality Ratio</em>)<a class="anchor" aria-label="anchor" href="#probabilidad-de-muerte-en-los-casos-reportados-cfr-por-case-fatality-ratio"></a>
</h3>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">casos</span><span class="op">$</span><span class="va">desenlace</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
      Muerte Recuperacion         &lt;NA&gt; 
          60           43           63 </code></pre>
</div>
<div id="desafío-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-1" class="callout-inner">
<h3 class="callout-title">Desafío 1<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo-1"></a>
</h3>
<div class="callout-content">
<p>Calcule la probabilidad de muerte en los casos reportados
(<code>CFR</code>) tomando el número de muertes y el número de casos con
desenlace final conocido del objeto casos. Esta vez se calculará el
<code>CFR</code> con el método <em>Naive</em>. Los cálculos
<em>Naive</em> (<em>inocentes</em>) tienen el problema de que pueden
presentar sesgos, por lo que no deberían ser utilizados para informar
decisiones de salud pública. Hablaremos de estos sesgos en profundidad
en el día 4.</p>
<p>Durante este taller se le presentarán algunos retos, para los cuales
obtendrá algunas pistas, por ejemplo en el presente reto se le presenta
una pista, la cual es un fragmento del código que usted debe completar
para alcanzar la solución. En los espacios donde dice
<code>COMPLETE</code> por favor diligencie el código faltante.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">muertes</span> <span class="op">&lt;-</span>  <span class="va">COMPLETE</span></span>
<span></span>
<span><span class="va">casos_desenlace_final_conocido</span> <span class="op">&lt;-</span> <span class="fu">sum</span><span class="op">(</span><span class="va">casos</span><span class="op">$</span><span class="va">desenlace</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Muerte"</span>, <span class="st">"Recuperacion"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">CFR</span> <span class="op">&lt;-</span> <span class="va">COMPLETE</span> <span class="op">/</span> <span class="va">COMPLETE</span></span></code></pre>
</div>
<p>Ejemplo,</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reto</span></span>
<span><span class="va">muertes</span> <span class="op">&lt;-</span>  <span class="va">COMPLETE</span></span>
<span><span class="co">#Solución</span></span>
<span><span class="va">muertes</span> <span class="op">&lt;-</span> <span class="fu">sum</span><span class="op">(</span><span class="va">casos</span><span class="op">$</span><span class="va">desenlace</span> <span class="op">%in%</span> <span class="st">"Muerte"</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.5825243</code></pre>
</div>
</div>
</div>
</div>

<p>Para complementar el calculo del CFR se pueden calcular sus
intervalos de confianza por medio de la función
<code>binom.confint</code>. La función <code>binom.confint</code> se
utiliza para calcular intervalos de confianza para una proporción en una
distribución binomial, que corresponde, por ejemplo, a cuando tenemos el
total de infecciones con desenlace final conocido (recuperado o muerte).
Esta función pide tres argumentos: 1) el número de muertes y 2) el
número total de casos con desenlace final conocido, es decir sin
importar que hayan muerto o se hayan recuperado, pero sin cuenta los
datos con <code>NA</code>; 3) el método que se utilizará para calcular
los intervalos de confianza, en este caso “<code>exact</code>” (método
Clopper-Pearson).</p>
<div id="desafío-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="desafío-2" class="callout-inner">
<h3 class="callout-title">Desafío 2<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo-2"></a>
</h3>
<div class="callout-content">
<p>Determine el CFR con sus intervalos de confianza utilizando la
función <code>binom.confint</code>. Y obtenga este resultado.</p>
<table class="table">
<caption><strong>CFR con intervalos de confianza</strong></caption>
<thead><tr class="header">
<th align="left">method</th>
<th align="right">x</th>
<th align="right">n</th>
<th align="right">mean</th>
<th align="right">lower</th>
<th align="right">upper</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">exact</td>
<td align="right">60</td>
<td align="right">103</td>
<td align="right">0.5825243</td>
<td align="right">0.4812264</td>
<td align="right">0.6789504</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Pista
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Recuerde diligenciar los espacios donde dice <code>COMPLETE</code>. Y
obtenga este resultado</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CFR_con_CI</span> <span class="op">&lt;-</span> <span class="fu">binom.confint</span><span class="op">(</span><span class="va">COMPLETE</span>, <span class="va">COMPLETE</span>, method <span class="op">=</span> <span class="st">"COMPLETE"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"**COMPLETE ¿QUE TITULO LE PONDRÍA?**"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CFR_con_CI</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>

</div>
</section><section id="incidencia"><h2 class="section-heading">3. Incidencia<a class="anchor" aria-label="anchor" href="#incidencia"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="curva-de-incidencia-diaria">3.1. Curva de incidencia diaria<a class="anchor" aria-label="anchor" href="#curva-de-incidencia-diaria"></a>
</h3>
<p>El paquete <code>incidence</code> es de gran utilidad para el
análisis epidemiológico de datos de incidencia de enfermedades
infecciosas, dado que permite calcular la incidencia a partir del
intervalo temporal suministrado (e.g. diario o semanal). Dentro de este
paquete esta la función <code>incidence</code> la cuenta con los
siguientes argumentos:</p>
<ol style="list-style-type: decimal">
<li><p><code>dates</code> contiene una variable con fechas que
representan cuándo ocurrieron eventos individuales, como por ejemplo la
fecha de inicio de los síntomas de una enfermedad en un conjunto de
pacientes.</p></li>
<li><p><code>interval</code> es un intervalo de tiempo fijo por el que
se quiere calcular la incidencia. Por ejemplo,
<code>interval = 365</code> para un año. Si no se especifica, el valor
por defecto es diario.</p></li>
<li><p><code>last_date</code> fecha donde se establecerá un limite
temporal para los datos. Por ejemplo, la última fecha de
hospitalización. Para este tercer argumento, podemos incluir la opción
<code>max</code> y la opción <code>na.rm</code>. La primera para obtener
la última fecha de una variable y la segunda para ignorar los
<code>NA</code> en caso de que existan.</p></li>
</ol>
<p>Por ejemplo, se podría escribir
<code>last_date = max(base_de_datos$vector_ultima_fecha, na.rm = TRUE)</code></p>
<p>Con esta información la función agrupa los casos según el intervalo
de tiempo especificado y cuenta el número de eventos (como casos de
enfermedad) que ocurrieron dentro de cada intervalo.</p>
<div id="desafío-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-3" class="callout-inner">
<h3 class="callout-title">Desafío 3<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo-3"></a>
</h3>
<div class="callout-content">
<p>Calcule la incidencia diaria usando únicamente el primer argumento de
la función <code>incidence</code> ¿Qué fecha sería la más adecuada?
Tenga en cuenta que se espera que esta sea la que pueda dar mejor
información, es decir la menor cantidad de <code>NA</code>s.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incidencia_diaria</span> <span class="op">&lt;-</span> <span class="fu">incidence</span><span class="op">(</span><span class="va">COMPLETE</span><span class="op">)</span></span>
<span><span class="va">incidencia_diaria</span></span></code></pre>
</div>
</div>
</div>
</div>
<p>El resultado es un objeto de clase incidencia
(<code>incidence</code>) que contiene el recuento de casos para cada
intervalo de tiempo, lo que facilita su visualización y análisis
posterior. Como puede observar la función produjo los siguientes
datos:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;incidence object&gt;
[166 cases from days 2014-04-07 to 2014-06-29]

$counts: matrix with 84 rows and 1 columns
$n: 166 cases in total
$dates: 84 dates marking the left-side of bins
$interval: 1 day
$timespan: 84 days
$cumulative: FALSE</code></pre>
</div>

<p>Como resultado de la función se produjo un objeto tipo lista. Este
objeto arroja estos datos: <code>166 casos</code> contemplados entre los
días <code>2014-04-07</code> al <code>2014-06-29</code> para un total de
<code>84 días</code>; se menciona que el intervalo es de
<code>1 día</code>, dado que no se utilizo específico explicitamente el
parámetro por lo cual quedó su valor por defecto. Finalmente se menciona
“<code>cumulative : FALSE</code>” lo que quiere decir que no se esta
haciendo el acumulado de la incidencia, es decir que los casos
corresponden a los del intervalo <code>interval: 1 day</code>, es decir
a los casos nuevos cada día en específico.</p>
<p>Ahora haga una gráfica de la incidencia diaria.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">incidencia_diaria</span>, border <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/TallerIntroAnaliticaBrotes-rendered-unnamed-chunk-15-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>En el <code>Eje X (Fechas)</code>: Se puede observar fechas van desde
el <code>7 de abril de 2014</code> hasta una fecha posterior al
<code>21 de junio de 2014</code>. Estas fechas representan el período de
observación del brote.</p>
<p>En el <code>Eje Y (Incidencia Diaria)</code>: La altura de las barras
indica el número de nuevos casos reportados cada fecha según el tipo de
fecha escogido.</p>
<p>Dado que no se agregó el parámetro <code>interval</code> la
incidencia quedó por defecto diaria, produciéndose un histograma en el
que cada barra representa la incidencia de un día, es decir, los casos
nuevos. Los días sin barras sugieren que no hubo casos nuevos para esa
fecha o que los datos podrían no estar disponibles para esos días.</p>
<p>A pesar de que hay una curva creciente, hay periodos con pocos o
ningún caso. ¿Porque cree que podrían darse estos periodos de pocos a
pesar de la curva creciente?</p>

</div>
<div class="section level3">
<h3 id="cálculo-de-la-incidencia-semanal">3.2. Cálculo de la incidencia semanal<a class="anchor" aria-label="anchor" href="#c%C3%A1lculo-de-la-incidencia-semanal"></a>
</h3>
<p>Teniendo en cuenta lo aprendido con respecto a la incidencia diaria,
cree una variable para incidencia semanal. Luego, interprete el
resultado y haga una gráfica. Para escoger la fecha que utilizará como
última fecha debe asignarle un valor al argumento <code>last_date</code>
de la función <code>incidence</code> ¿Qué fecha sería la más adecuada?
Tenga en cuenta que la fecha debe ser posterior a la fecha que se haya
escogido como el primer argumento.</p>
<div id="desafío-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-4" class="callout-inner">
<h3 class="callout-title">Desafío 4<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo-4"></a>
</h3>
<div class="callout-content">
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>incidencia_semanal <span class="ot">&lt;-</span> <span class="fu">incidence</span>(PRIMER ARGUMENTO,  <span class="co">#COMPLETE</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                                SEGUNDO ARGUMENTO, <span class="co">#COMPLETE </span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                                TERCER ARGUMENTO)  <span class="co">#COMPLETE</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;incidence object&gt;
[166 cases from days 2014-04-07 to 2014-06-30]
[166 cases from ISO weeks 2014-W15 to 2014-W27]

$counts: matrix with 13 rows and 1 columns
$n: 166 cases in total
$dates: 13 dates marking the left-side of bins
$interval: 7 days
$timespan: 85 days
$cumulative: FALSE</code></pre>
</div>
<figure><img src="fig/TallerIntroAnaliticaBrotes-rendered-unnamed-chunk-17-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>

<p>Compare la gráfica de incidencia diaria con la de incidencia semanal.
¿Qué observa? ¿Los datos se comportan diferente? ¿Es lo que esperaba?
¿Logra observar alguna tendencia?</p>
</div>
</section><section id="tasa-de-crecimiento"><h2 class="section-heading">4. Tasa de crecimiento<a class="anchor" aria-label="anchor" href="#tasa-de-crecimiento"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="modelo-log-lineal">4.1. Modelo log-lineal<a class="anchor" aria-label="anchor" href="#modelo-log-lineal"></a>
</h3>
<div class="section level4">
<h4 id="estimación-de-la-tasa-de-crecimiento-mediante-un-modelo-log-lineal">Estimación de la tasa de crecimiento mediante un modelo
log-lineal<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-de-la-tasa-de-crecimiento-mediante-un-modelo-log-lineal"></a>
</h4>
<p>Para observar mejor las tendencias de crecimiento en el número de
casos se puede visualizar la incidencia semanal en una escala
logarítmica. Esto es particularmente útil para identificar patrones
exponenciales en los datos.</p>
<p>Grafique la incidencia transformada logarítmicamente:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">as.data.frame</span><span class="op">(</span><span class="va">incidencia_semanal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dates</span>, y <span class="op">=</span> <span class="fu">log</span><span class="op">(</span><span class="va">counts</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_x_incidence</span><span class="op">(</span><span class="va">incidencia_semanal</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Semana"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Incidencia semanal logarítmica"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/TallerIntroAnaliticaBrotes-rendered-unnamed-chunk-19-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level4">
<h4 id="interpretación-del-modelo">Ajuste un modelo log-lineal a los datos de incidencia semanal<a class="anchor" aria-label="anchor" href="#interpretaci%C3%B3n-del-modelo"></a>
</h4>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ajuste_modelo</span> <span class="op">&lt;-</span> <span class="fu">incidence</span><span class="fu">::</span><span class="fu">fit</span><span class="op">(</span><span class="va">incidencia_semanal</span><span class="op">)</span></span>
<span><span class="va">ajuste_modelo</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;incidence_fit object&gt;

$model: regression of log-incidence over time

$info: list containing the following items:
  $r (daily growth rate):
[1] 0.04145251

  $r.conf (confidence interval):
          2.5 %     97.5 %
[1,] 0.02582225 0.05708276

  $doubling (doubling time in days):
[1] 16.72148

  $doubling.conf (confidence interval):
        2.5 %   97.5 %
[1,] 12.14285 26.84302

  $pred: data.frame of incidence predictions (12 rows, 5 columns)</code></pre>
</div>
<div id="desafío-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="desafío-5" class="callout-inner">
<h3 class="callout-title">Desafío 5<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo-5"></a>
</h3>
<div class="callout-content">
<p>¿Qué observa en este resultado?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Solución
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p><code>$model</code>: Indica que se ha realizado una regresión
logarítmica de la incidencia en función del tiempo. Esto implica que la
relación entre el tiempo y la incidencia de la enfermedad ha sido
modelada como una función lineal en escalá logarítmica en la incidencia
con el fin de entender mejor las tendencias de crecimiento.</p>
<p><code>$info</code>: Contiene varios componentes importantes del
análisis:</p>
<ol style="list-style-type: decimal">
<li>
<code>$r (daily growth rate)</code> Tasa de crecimiento diaria:
<code>0.04145251</code>
</li>
</ol>
<p>La tasa de crecimiento diaria estimada del brote es de
<code>0.0415</code>. Esto significa que cada día la cantidad de casos
está creciendo en un <code>4.15%</code> con respecto al día anterior,
bajo la suposición de un crecimiento exponencial constante durante el
periodo modelado.</p>
<p>Si quisiera acceder a esta información sin ingresar al modelo podría
hacerlo con el siguiente código</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tasa_crecimiento_diaria</span> <span class="op">&lt;-</span> <span class="va">ajuste_modelo</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">r</span></span>
<span><span class="fu">cat</span><span class="op">(</span><span class="st">"La tasa de crecimiento diaria es:"</span>, <span class="va">tasa_crecimiento_diaria</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>La tasa de crecimiento diaria es: 0.04145251 </code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>
<code>$r.conf</code> (confidence interval): 2.5 % 0.02582225 97.5 %
0.05708276</li>
</ol>
<p>El intervalo de confianza del <code>95%</code> para la tasa de
crecimiento diaria está entre <code>0.0258 (2.58%)</code> y
<code>0.0571 (5.71%)</code>.</p>
<p><code>$doubling</code> (doubling time in days): 16.72148</p>
<ol start="3" style="list-style-type: decimal">
<li>El tiempo de duplicación estimado del número de casos nuevos es de
aproximadamente <code>16.72 días</code>. Esto significa que, bajo el
modelo actual y con la tasa de crecimiento estimada, se espera que el
número de casos de la curva epidémica actual se duplique cada
<code>16.72 días</code>.</li>
</ol>
<p><code>$doubling.conf</code> (confidence interval): 2.5 % 12.14285
97.5 % 26.84302</p>
<ol start="4" style="list-style-type: decimal">
<li>El intervalo de confianza del <code>95%</code> para el tiempo de
duplicación está entre aproximadamente <code>12.14</code> y
<code>26.84 días</code>. Este amplio rango refleja la incertidumbre en
la estimación y puede ser consecuencia de la variabilidad en los datos o
de un tamaño de muestra pequeño.</li>
</ol>
<p><code>$pred</code>: Contiene las predicciones de incidencia
observada. Incluye las fechas, la escala de tiempo en días desde el
inicio del brote, los valores ajustados (predicciones), los límites
inferior y superior del intervalo de confianza para las
predicciones.</p>
<p>Si quiere conocer un poco más de este componente puede explorarlo con
la función <code>glimpse</code>.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">ajuste_modelo</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">pred</span><span class="op">)</span></span></code></pre>
</div>
<p>¿El modelo se ajusta bien a los datos? Verifique el <span class="math inline">\(R^2\)</span></p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AjusteR2modelo</span> <span class="op">&lt;-</span> <span class="fu">summary</span><span class="op">(</span><span class="va">ajuste_modelo</span><span class="op">$</span><span class="va">model</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span></span>
<span><span class="fu">cat</span><span class="op">(</span><span class="st">"El R cuadrado ajustado es:"</span>, <span class="va">AjusteR2modelo</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>El R cuadrado ajustado es: 0.7551113 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Antes de continuar ¿Considera más adecuado usar una gráfica semanal
para buscar un ajuste de los datos? ¿Por qué?</p>
<p>¿Es preferible calcular la tasa de crecimiento diaria con el ajuste
semanal y no con el ajuste diario?</p>

<p>Grafique la incidencia incluyendo una línea que represente el
modelo.</p>
<p>Con <code>plot</code></p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">incidencia_semanal</span>, fit <span class="op">=</span> <span class="va">ajuste_modelo</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/TallerIntroAnaliticaBrotes-rendered-unnamed-chunk-24-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Tras ajustar el modelo log-lineal a la incidencia semanal para
estimar la tasa de crecimiento de la epidemia el gráfico muestra la
curva de ajuste superpuesta a la incidencia semanal observada.</p>
<p>Al final del gráfico se puede observar que la incidencia semanal
disminuye.</p>
<p>¿Porqué cree que podría estar pasando esto? ¿Cómo lo
solucionaría?</p>

</div>
</div>
<div class="section level3">
<h3 id="modelo-log-lineal-con-datos-truncados">4.2. Modelo log-lineal con datos truncados<a class="anchor" aria-label="anchor" href="#modelo-log-lineal-con-datos-truncados"></a>
</h3>
<div class="section level4">
<h4 id="encuentre-una-fecha-límite-adecuada-para-el-modelo-log-lineal-en-función-de-los-rezagos-biológicos-y-administrativos-">Encuentre una fecha límite adecuada para el modelo log-lineal, en
función de los rezagos (biológicos y administrativos).<a class="anchor" aria-label="anchor" href="#encuentre-una-fecha-l%C3%ADmite-adecuada-para-el-modelo-log-lineal-en-funci%C3%B3n-de-los-rezagos-biol%C3%B3gicos-y-administrativos-"></a>
</h4>
<p>Dado que esta epidemia es de ébola y la mayoría de los casos van a
ser hospitalizados, es muy probable que la mayoría de las notificaciones
ocurran en el momento de la hospitalización. De tal manera que podríamos
examinar cuánto tiempo transcurre entre la fecha de inicio de síntomas y
la fecha de hospitalización para hacernos una idea del rezago para esta
epidemia.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">casos</span><span class="op">$</span><span class="va">fecha_de_hospitalizacion</span> <span class="op">-</span> <span class="va">casos</span><span class="op">$</span><span class="va">fecha_inicio_sintomas</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    1.00    2.00    3.53    5.00   22.00 </code></pre>
</div>
<p>Al restar la fecha de hospitalización a la fecha de inicio de
síntomas podría haber valores negativos. ¿Cual cree que sea su
significado? ¿Ocurre en este caso?</p>
<p>Para evitar el sesgo debido a rezagos en la notificación, se pueden
truncar los datos de incidencia. Pruebe descartar las últimas dos
semanas. Este procedimiento permite concentrarse en el periodo en que
los datos son más completos para un análisis más fiable.</p>
<p>Semanas a descartar al final de la epicurva</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">semanas_a_descartar</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">fecha_minima</span> <span class="op">&lt;-</span> <span class="fu">min</span><span class="op">(</span><span class="va">incidencia_diaria</span><span class="op">$</span><span class="va">dates</span><span class="op">)</span></span>
<span><span class="va">fecha_maxima</span> <span class="op">&lt;-</span> <span class="fu">max</span><span class="op">(</span><span class="va">incidencia_diaria</span><span class="op">$</span><span class="va">dates</span><span class="op">)</span> <span class="op">-</span> <span class="va">semanas_a_descartar</span> <span class="op">*</span> <span class="fl">7</span></span>
<span></span>
<span><span class="co"># Para truncar la incidencia semanal</span></span>
<span><span class="va">incidencia_semanal_truncada</span> <span class="op">&lt;-</span> <span class="fu">subset</span><span class="op">(</span><span class="va">incidencia_semanal</span>, </span>
<span>                         from <span class="op">=</span> <span class="va">fecha_minima</span>, </span>
<span>                         to <span class="op">=</span> <span class="va">fecha_maxima</span><span class="op">)</span> <span class="co"># descarte las últimas semanas de datos</span></span>
<span></span>
<span><span class="co"># Incidencia diaria truncada. No la usamos para la regresión lineal pero se puede usar más adelante</span></span>
<span><span class="va">incidencia_diaria_truncada</span> <span class="op">&lt;-</span> <span class="fu">subset</span><span class="op">(</span><span class="va">incidencia_diaria</span>, </span>
<span>                        from <span class="op">=</span> <span class="va">fecha_minima</span>, </span>
<span>                        to <span class="op">=</span> <span class="va">fecha_maxima</span><span class="op">)</span> <span class="co"># eliminamos las últimas dos semanas de datos</span></span></code></pre>
</div>
<div id="desafío-6" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-6" class="callout-inner">
<h3 class="callout-title">Desafío 6<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo-6"></a>
</h3>
<div class="callout-content">
<p>Ahora utilizando los datos truncados
<code>incidencia_semanal_truncada</code> vuelva a ajustar el modelo
logarítmico lineal.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;incidence_fit object&gt;

$model: regression of log-incidence over time

$info: list containing the following items:
  $r (daily growth rate):
[1] 0.05224047

  $r.conf (confidence interval):
          2.5 %    97.5 %
[1,] 0.03323024 0.0712507

  $doubling (doubling time in days):
[1] 13.2684

  $doubling.conf (confidence interval):
        2.5 %   97.5 %
[1,] 9.728286 20.85893

  $pred: data.frame of incidence predictions (10 rows, 5 columns)</code></pre>
</div>
</div>
</div>
</div>

<p>¿Como interpreta estos resultados? ¿Compare los <span class="math inline">\(R^2\)</span>?</p>
<div id="desafío-7" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-7" class="callout-inner">
<h3 class="callout-title">Desafío 7<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo-7"></a>
</h3>
<div class="callout-content">
<p>Ahora utilizando los datos truncados
<code>incidencia_semanal_truncada</code> vuelva a graficar el modelo
logarítmico lineal.</p>
<figure><img src="fig/TallerIntroAnaliticaBrotes-rendered-unnamed-chunk-29-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>

<p>¿Qué cambios observa?</p>
<p>Observe las estadísticas resumidas del ajuste:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">ajuste_modelo_truncado</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
stats::lm(formula = log(counts) ~ dates.x, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.73474 -0.31655 -0.03211  0.41798  0.65311 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.186219   0.332752   0.560 0.591049    
dates.x     0.052240   0.008244   6.337 0.000224 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5241 on 8 degrees of freedom
Multiple R-squared:  0.8339,	Adjusted R-squared:  0.8131 
F-statistic: 40.16 on 1 and 8 DF,  p-value: 0.0002237</code></pre>
</div>
<p>El modelo muestra que hay una relación significativa
(<code>R-squared: 0.8131</code>) entre el tiempo (<code>dates.x</code>)
y la incidencia de la enfermedad, por lo que concluimos que la
enfermedad muestra un crecimiento exponencial a lo largo del tiempo.</p>
</div>
</div>
<div class="section level3">
<h3 id="tasa-de-crecimiento-y-tasa-de-duplicación-extracción-de-datos">4.3. Tasa de crecimiento y tasa de duplicación: extracción de
datos<a class="anchor" aria-label="anchor" href="#tasa-de-crecimiento-y-tasa-de-duplicaci%C3%B3n-extracci%C3%B3n-de-datos"></a>
</h3>
<div class="section level4">
<h4 id="estimacion-de-la-tasa-de-crecimiento">Estimacion de la tasa de crecimiento<a class="anchor" aria-label="anchor" href="#estimacion-de-la-tasa-de-crecimiento"></a>
</h4>
<p>Para estimar la tasa de crecimiento de una epidemia utilizando un
modelo log-lineal es necesario realizar un ajuste de regresión a los
datos de incidencia. Dado que ya tiene un objeto de incidencia truncado
y un modelo log-lineal ajustado, puede proceder a calcular la tasa de
crecimiento diaria y el tiempo de duplicación de la epidemia.</p>
<p>El modelo log-lineal proporcionará los coeficientes necesarios para
estos cálculos. Note que el coeficiente asociado con el tiempo (la
pendiente de la regresión) se puede interpretar como la tasa de
crecimiento diaria cuando el tiempo se expresa en días.</p>
<p>Con el modelo ajustado truncado, es hora de realizar la estimación de
la tasa de crecimiento. Estos datos los puede encontrar en el objeto
ajuste modelo semana, que tiene los datos ajustados de incidencia
semanal truncada.</p>
<div id="desafío-8" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-8" class="callout-inner">
<h3 class="callout-title">Desafío 8<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo-8"></a>
</h3>
<div class="callout-content">
<p>Por favor escriba el código para obtener los siguientes valores:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>La tasa de crecimiento diaria es: 0.05224047 </code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Intervalo de confianza de la tasa de crecimiento diaria (95%): 0.03323024 0.0712507 </code></pre>
</div>
</div>
</div>
</div>

<p>Si no lo recuerda, vuelva por pistas a la sección <a href="#interpretaci%C3%B3n-del-modelo">Ajuste un modelo log-lineal a los
datos de incidencia semanal</a></p>
<p>Ahora que ya ha obtenido la tasa de crecimiento diaria y sus
intervalos de confianza, puede pasar a estimar el tiempo de
duplicación.</p>
</div>
<div class="section level4">
<h4 id="estimacion-del-tiempo-de-duplicación">Estimacion del tiempo de duplicación<a class="anchor" aria-label="anchor" href="#estimacion-del-tiempo-de-duplicaci%C3%B3n"></a>
</h4>
<p>Esta información también la encontrará calculada y lista para
utilizar en el objeto <code>ajuste_modelo_truncado</code>, que tiene los
datos ajustados de incidencia semanal truncada.</p>
<div id="desafío-9" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-9" class="callout-inner">
<h3 class="callout-title">Desafío 9<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo-9"></a>
</h3>
<div class="callout-content">
<p>Por favor escriba el código para obtener los siguientes valores:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>El tiempo de duplicación de la epidemia es 13.2684 días</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Intervalo de confianza del tiempo de duplicación (95%): 9.728286 20.85893 </code></pre>
</div>
</div>
</div>
</div>

<p>Si no lo recuerda vuelva por pistas a la sección <a href="#interpretaci%C3%B3n-del-modelo">Ajuste un modelo log-lineal a los
datos de incidencia semanal</a></p>
</div>
</div>
</section><section id="estimación-de-numero-de-reproduccion"><h2 class="section-heading">5. Estimación de numero de reproduccion<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-de-numero-de-reproduccion"></a>
</h2>
<hr class="half-width">
<p>Evaluar la velocidad a la que se propaga una infección en una
población es una tarea importante a la hora de informar la respuesta de
salud pública a una epidemia.</p>
<p>Los números de reproducción son métricas típicas para monitorear el
desarrollo de epidemias y son informativos sobre su velocidad de
propagación. El <strong>número reproductivo básico</strong> <span class="math inline">\(R_0\)</span>, por ejemplo, mide el número promedio
de casos secundarios producidos por un individuo infeccioso dada una
población completamente susceptible. Esta hipótesis suele ser válida
solo al inicio de una epidemia.</p>
<p>Para caracterizar el la propagación en tiempo real es más común
utilizar el <strong>número reproductivo instantáneo</strong> <span class="math inline">\(R_t\)</span>, el cual describe el número promedio
de casos secundarios generados por un individuo infeccioso en el tiempo
<span class="math inline">\(t\)</span> dado que no han habido cambios en
las condiciones actuales.</p>
<p>En esta sección exploraremos los conceptos necesarios para calcular
el número reproductivo instantáneo, así como los pasos a seguir para
estimarlo por medio del paquete de R <a href="https://github.com/mrc-ide/EpiEstim" class="external-link">EpiEstim</a>.</p>
<div class="section level3">
<h3 id="intervalo-serial-si">5.1. Intervalo serial (SI)<a class="anchor" aria-label="anchor" href="#intervalo-serial-si"></a>
</h3>
<p>¿Qué es el intervalo serial?</p>
<p>El intervalo serial en epidemiología se refiere al tiempo que
transcurre entre el momento en que una persona infectada (el caso
primario) comienza a mostrar síntomas y el momento en que la persona que
fue infectada por ella (el caso secundario) comienza a mostrar
síntomas.</p>
<p>Este intervalo es importante porque ayuda a entender qué tan rápido
se está propagando una enfermedad y a diseñar estrategias de control
como el rastreo de contactos y la cuarentena. Si el intervalo serial es
corto, puede significar que la enfermedad se propaga rápidamente y que
es necesario actuar con urgencia para contenerla. Si es largo, puede
haber más tiempo para intervenir antes de que la enfermedad se disemine
ampliamente.</p>
<p>Para este brote de ébola asumiremos que el intervalo serial está
descrito por una distribución Gamma de media (<code>mean_si</code>) de
<code>8.7 días</code> y con una desviación estándar
(<code>std_si</code>) de <code>6.1 días</code>. En la práctica del día 4
estudiaremos cómo estimar el intervalo serial.</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parametros de la distribución gamma para el invertavlo serial</span></span>
<span><span class="va">mean_si</span> <span class="op">&lt;-</span> <span class="fl">8.7</span></span>
<span><span class="va">std_si</span> <span class="op">&lt;-</span>  <span class="fl">6.1</span></span>
<span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">make_config</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>mean_si <span class="op">=</span> <span class="va">mean_si</span>, std_si <span class="op">=</span> <span class="va">std_si</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># t_start y t_end se configuran automáticamente para estimar R en ventanas deslizantes para 1 semana de forma predeterminada.</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="estimación-de-la-transmisibilidad-variable-en-el-tiempo-rt">5.2. Estimación de la transmisibilidad variable en el tiempo,
R(t)<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-de-la-transmisibilidad-variable-en-el-tiempo-rt"></a>
</h3>
<p>Cuando la suposición de que (<span class="math inline">\(R\)</span>)
es constante en el tiempo se vuelve insostenible, una alternativa es
estimar la transmisibilidad variable en el tiempo utilizando el número
de reproducción instantánea (<span class="math inline">\(R_t\)</span>).
Este enfoque, introducido por Cori et al. (2013), se implementa en el
paquete <code>EpiEstim</code>, el cual estima el <span class="math inline">\(R_t\)</span> para ventanas de tiempo
personalizadas, utilizando la una distribución de Poisson. A
continuación, estimamos la transmisibilidad para ventanas de tiempo
deslizantes de 1 semana (el valor predeterminado de
<code>estimate_R</code>):</p>
<hr>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">make_config</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>mean_si <span class="op">=</span> <span class="va">mean_si</span>, std_si <span class="op">=</span> <span class="va">std_si</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># t_start y t_end se configuran automáticamente para estimar R en ventanas deslizantes para 1 semana de forma predeterminada.</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use estimate_R using method = "parametric_si"</span></span>
<span><span class="va">estimacion_rt</span> <span class="op">&lt;-</span> <span class="fu">estimate_R</span><span class="op">(</span><span class="va">incidencia_diaria_truncada</span>, method <span class="op">=</span> <span class="st">"parametric_si"</span>, </span>
<span>                            si_data <span class="op">=</span> <span class="va">si_data</span>,</span>
<span>                            config <span class="op">=</span> <span class="va">config</span><span class="op">)</span></span>
<span><span class="co"># Observamos las primeras estimaciones de R(t)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">estimacion_rt</span><span class="op">$</span><span class="va">R</span><span class="op">[</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"t_start"</span>, <span class="st">"t_end"</span>, <span class="st">"Median(R)"</span>, </span>
<span>                         <span class="st">"Quantile.0.025(R)"</span>, <span class="st">"Quantile.0.975(R)"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  t_start t_end Median(R) Quantile.0.025(R) Quantile.0.975(R)
1       2     8        NA                NA                NA
2       3     9  2.173592         0.3136801          7.215718
3       4    10  2.148673         0.3100840          7.132996
4       5    11  2.060726         0.2973920          6.841036
5       6    12  1.960940         0.2829915          6.509775
6       7    13  1.869417         0.2697834          6.205943</code></pre>
</div>
<p>Grafique la estimación de <span class="math inline">\(R\)</span> como
función del tiempo:</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">estimacion_rt</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/TallerIntroAnaliticaBrotes-rendered-unnamed-chunk-40-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><hr>
<div class="section level4">
<h4 id="sobre-este-documento">Sobre este documento<a class="anchor" aria-label="anchor" href="#sobre-este-documento"></a>
</h4>
<p>Este documento ha sido una adaptación de los materiales originales
disponibles en <a href="https://www.reconlearn.org/" class="external-link">RECON Learn</a></p>
</div>
<div class="section level4">
<h4 id="contribuciones">Contribuciones<a class="anchor" aria-label="anchor" href="#contribuciones"></a>
</h4>
<p>Autores originales:</p>
<ul>
<li><p>Anne Cori</p></li>
<li><p>Natsuko Imai</p></li>
<li><p>Finlay Campbell</p></li>
<li><p>Zhian N. Kamvar</p></li>
<li><p>Thibaut Jombart</p></li>
</ul>
<p>Cambios menores y adaptación a español:</p>
<ul>
<li><p>José M. Velasco-España</p></li>
<li><p>Cándida Díaz-Brochero</p></li>
<li><p>Nicolas Torres</p></li>
<li><p>Zulma M. Cucunubá</p></li>
</ul>
<div id="puntos-clave" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div id="puntos-clave" class="callout-inner">
<h3 class="callout-title">Puntos clave<a class="anchor" aria-label="anchor" href="#puntos-clave"></a>
</h3>
<div class="callout-content">
<p>Revise si al final de esta lección adquirió estas competencias:</p>
<ul>
<li><p>Identificar los parámetros necesarios en casos de transmisión de
enfermedades infecciosas de persona a persona.</p></li>
<li><p>Estimar la probabilidad de muerte (CFR).</p></li>
<li><p>Calcular y graficar la incidencia.</p></li>
<li><p>Estimar e interpretar la tasa de crecimiento y el tiempo en que
se duplica la epidemia.</p></li>
<li><p>Estimar e interpretar el número de reproducción instantáneo de la
epidemia.</p></li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</div>
</section></section><section id="aio-ZIKAB"><p>Content from <a href="ZIKAB.html">Taller Día 3 - Construyendo un modelo matemático simple para Zika.</a></p>
<hr>
<p> Last updated on 2023-12-03 | 
        
        <a href="https://github.com/Joskerus/Nuevoformato/edit/main/episodes/ZIKAB.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>¿Cómo construir un modelo simplificado de zika?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<p>Al final de este taller usted podrá:</p>
<ul>
<li>Aplicar conceptos como parámetros, <span class="math inline">\(R_0\)</span> e inmunidad de rebaño, aprendidos en
la sesión A del taller</li>
<li>Traducir fórmulas matemáticas de las interacciones entre los
parámetros del modelo a código de R</li>
<li>Realizar un modelo simple en R para una enfermedad transmitida por
vector</li>
<li>Discutir cambios en las proyecciones del modelo cuando se instauran
diferentes estrategias de control de la infección</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="introducción"><h2 class="section-heading">1. Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>En este taller usted aplicará los conceptos básicos del
<strong>modelamiento de Enfermedades Transmitidas por Vectores
(ETV)</strong> mediante el uso del lenguaje R con énfasis en el
funcionamiento de los métodos, utilizando como ejemplo un modelo básico
de infección por un arbovirus: el virus del Zika.</p>
</section><section id="agenda"><h2 class="section-heading">2. Agenda<a class="anchor" aria-label="anchor" href="#agenda"></a>
</h2>
<hr class="half-width">
<ul>
<li>Instrucciones (5 mins)</li>
<li>Desarrollo taller Zika Parte B (45 mins con acompañamiento de
monitores)</li>
<li>Revisión grupal del código (10 mins)</li>
<li>Revisión de resultados (20 mins)</li>
<li>Descanso (25 mins)</li>
<li>Discusión final (60 mins)</li>
</ul></section><section id="conceptos-básicos-a-desarrollar"><h2 class="section-heading">3. Conceptos básicos a desarrollar<a class="anchor" aria-label="anchor" href="#conceptos-b%C3%A1sicos-a-desarrollar"></a>
</h2>
<hr class="half-width">
<p>En esta práctica se desarrollarán los siguientes conceptos:</p>
<ul>
<li>Modelo SIR para ETV Zika</li>
<li>Parametrización de un modelo dinámico</li>
<li>Evaluación de un modelo dinámico</li>
<li>Parametrización de intervenciones de control (fumigación,
mosquiteros y vacunación) para una ETV</li>
</ul></section><section id="paquetes-requeridos"><h2 class="section-heading">4. Paquetes requeridos<a class="anchor" aria-label="anchor" href="#paquetes-requeridos"></a>
</h2>
<hr class="half-width">
<p>Cargue los paquetes necesarios ingresando en R los siguientes
comandos:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">deSolve</span><span class="op">)</span>   <span class="co"># Paquete deSolve para resolver las ecuaciones diferenciales</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span> <span class="co"># Paquetes ggplot2 y dplyr de tidyverse</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">cowplot</span><span class="op">)</span> <span class="co"># Paquete gridExtra para unir gráficos.</span></span></code></pre>
</div>
<ul>
<li>Si desea puede tomar notas en el script de R, para esto se
recomienda usar el símbolo de comentario <em>#</em> después de cada
línea de código (ver ejemplo arriba). O podría utilizar un archivo Rmd
para tener un aspecto similar al del taller.</li>
</ul></section><section id="compartimentos-del-modelo-básico-de-zika"><h2 class="section-heading">5. Compartimentos del modelo básico de Zika<a class="anchor" aria-label="anchor" href="#compartimentos-del-modelo-b%C3%A1sico-de-zika"></a>
</h2>
<hr class="half-width">
<ul>
<li>
<span class="math inline">\(S_h\)</span> : Humanos susceptibles</li>
<li>
<span class="math inline">\(I_h\)</span> : Humanos infecciosos</li>
<li>
<span class="math inline">\(R_h\)</span> : Humanos recuperados de la
infección (inmunizados frente a nueva infección)</li>
<li>
<span class="math inline">\(S_v\)</span> : Vectores
susceptibles</li>
<li>
<span class="math inline">\(E_v\)</span> : Vectores expuestos</li>
<li>
<span class="math inline">\(I_v\)</span> : Vectores infecciosos</li>
</ul></section><section id="parámetros-del-modelo"><h2 class="section-heading">6. Parámetros del modelo<a class="anchor" aria-label="anchor" href="#par%C3%A1metros-del-modelo"></a>
</h2>
<hr class="half-width">
<p>Ahora se usarán los parámetros que discutimos en la parte A del
taller. Si aún no los tiene, estos se pueden encontrar en la guía de
aprendizaje de la parte A del taller.</p>
<div id="desafío-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-1" class="callout-inner">
<h3 class="callout-title">Desafío 1<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo-1"></a>
</h3>
<div class="callout-content">
<p>Busque los valores de los parámetros del modelo y diligéncielos en el
recuadro de abajo. Tenga en cuenta que todos los parámetros usados
tienen la misma unidad de tiempo (días).</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Lv       <span class="ot">&lt;-</span>        <span class="co"># Esperanza de vida de los mosquitos (en días)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Lh       <span class="ot">&lt;-</span>        <span class="co"># Esperanza de vida de los humanos (en días)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>PIh      <span class="ot">&lt;-</span>        <span class="co"># Periodo infeccioso en humanos (en días)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>PIv      <span class="ot">&lt;-</span>        <span class="co"># Periodo infeccioso en vectores (en días)</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>PEI      <span class="ot">&lt;-</span>        <span class="co"># Período extrínseco de incubación en mosquitos adultos (en días)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>muv      <span class="ot">&lt;-</span>        <span class="co"># Tasa per capita de mortalidad del vector (1/Lv)</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>muh      <span class="ot">&lt;-</span>        <span class="co"># Tasa per capita de mortalidad del hospedador (1/Lh)</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>alphav   <span class="ot">&lt;-</span>        <span class="co"># Tasa per capita de natalidad del vector</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>alphah   <span class="ot">&lt;-</span>        <span class="co"># Tasa per capita de natalidad del hospedador</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>gamma    <span class="ot">&lt;-</span>        <span class="co"># Tasa de recuperación en humanos (1/PIh)</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>delta    <span class="ot">&lt;-</span>        <span class="co"># Tasa extrínseca de incubación (1/PEI)</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>ph       <span class="ot">&lt;-</span>        <span class="co"># Probabilidad de transmisión del vector al hospedador dada una picadura por un mosquito infeccioso a un humano susceptible</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>pv       <span class="ot">&lt;-</span>        <span class="co"># Probabilidad de transmisión del hospedador al vector dada una picadura por un mosquito susceptible a un humano infeccioso</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>Nh       <span class="ot">&lt;-</span>        <span class="co"># Número de humanos</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>m        <span class="ot">&lt;-</span>        <span class="co"># Densidad de mosquitos hembra por humano</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>Nv       <span class="ot">&lt;-</span>        <span class="co"># Número de vectores (m * Nh)</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>R0       <span class="ot">&lt;-</span>        <span class="co"># Número reproductivo básico</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>b        <span class="ot">&lt;-</span>        <span class="fu">sqrt</span>((R0 <span class="sc">*</span> muv<span class="sc">*</span>(muv<span class="sc">+</span>delta) <span class="sc">*</span> (muh<span class="sc">+</span>gamma)) <span class="sc">/</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>                   (m <span class="sc">*</span> ph <span class="sc">*</span> pv <span class="sc">*</span> delta)) <span class="co"># Tasa de picadura</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>betah    <span class="ot">&lt;-</span>        <span class="co"># Coeficiente de transmisión del mosquito al humano</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>betav    <span class="ot">&lt;-</span>        <span class="co"># Coeficiente de transmisión del humano al mosquito</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>TIME     <span class="ot">&lt;-</span>        <span class="co"># Número de años que se va a simular </span></span></code></pre>
</div>
</div>
</div>
</div>

</section><section id="ecuaciones-del-modelo"><h2 class="section-heading">7. Ecuaciones del modelo<a class="anchor" aria-label="anchor" href="#ecuaciones-del-modelo"></a>
</h2>
<hr class="half-width">
<p>Para este modelo emplearemos las siguientes ecuaciones
diferenciales:</p>
<div class="section level3">
<h3 id="humanos">7.1 Humanos<a class="anchor" aria-label="anchor" href="#humanos"></a>
</h3>
<p><span class="math display">\[\ \frac{dSh}{dt}  = \alpha_h N_h -
\beta_h \frac {I_v}{N_h}S_h - \mu_h  S_h \]</span></p>
<p><span class="math display">\[\ \frac{dIh}{dt}  = \beta_h \frac
{I_v}{N_h}S_h - (\gamma + \mu_h) I_h \]</span><br></p>
<p><span class="math display">\[\ \frac{dRh}{dt}  = \gamma I_h  - \mu_h
R_h\]</span></p>
</div>
<div class="section level3">
<h3 id="vectores">7.2 Vectores<a class="anchor" aria-label="anchor" href="#vectores"></a>
</h3>
<p><span class="math display">\[\ \frac{dSv}{dt}  = \alpha_v N_v  -
\beta_v \frac{ I_h} {N_h}S_v  - \mu_v Sv\]</span></p>
<p><span class="math display">\[\ \frac{dE_v}{dt}  = \beta_v \frac{I_h}
{N_h}S_v- (\delta + \mu_v) Ev\]</span><br></p>
<p><span class="math display">\[\ \frac{dI_v}{dt}  = \delta Ev - \mu_v
I_v\]</span></p>
</div>
</section><section id="fórmula-para-calcular-r_0-número-reproductivo-básico"><h2 class="section-heading">8. Fórmula para calcular <span class="math inline">\(R_0\)</span>
(Número reproductivo básico)<a class="anchor" aria-label="anchor" href="#f%C3%B3rmula-para-calcular-r_0-n%C3%BAmero-reproductivo-b%C3%A1sico"></a>
</h2>
<hr class="half-width">
<p>Fórmula necesaria para estimar <span class="math inline">\(R_0\)</span>:</p>
<p><span class="math display">\[ R_0 = \frac{mb^2 p_h p_v \delta}{\mu_v
(\mu_v+\delta)(\mu_h+\gamma)} \]</span></p>
</section><section id="modelo-en-r"><h2 class="section-heading">9. Modelo en R<a class="anchor" aria-label="anchor" href="#modelo-en-r"></a>
</h2>
<hr class="half-width">
<p>Es hora de implementar el modelo en R. Para lograrlo, usaremos la
función <code>ode</code> del paquete <em>desolve</em>. Para el ejercicio
se emplearán 4 argumentos de la función esta función: el primero son las
condiciones iniciales del modelo (argumento <code>y</code>); el segundo
es la secuencia temporal donde se ejecutará el modelo (argumento
<code>times</code>); el tercero es una función que contiene las
ecuaciones diferenciales que entrarán al sistema (argumento
<code>fun</code>); por último un vector que contiene los parámetros con
los que se calculará el sistema (argumento <code>parms</code>).</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NO la copie a R sólo tiene fines ilustrativos.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ode</span>(<span class="at">y      =</span> <span class="co"># Condiciones iniciales,</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">times  =</span> <span class="co"># Tiempo,</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun    =</span> <span class="co"># Modelo o función que lo contenga,</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">parms  =</span> <span class="co"># Parámetros</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<div id="desafío-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-2" class="callout-inner">
<h3 class="callout-title">Desafío 2<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo-2"></a>
</h3>
<div class="callout-content">
<p>En esta sección se empezará por crear la función (argumento
<code>fun</code>), para ello es necesario traducir las ecuaciones del
modelo a R. Abajo encontrará la función ya construida, por favor
reemplace los parámetros faltantes (Cambie <em>PAR</em> por los
parámetro correspondientes) en las ecuaciones:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arbovmodel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">x</span>, <span class="va">params</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">Sh</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>    <span class="co"># Humanos susceptibles</span></span>
<span>  <span class="va">Ih</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>    <span class="co"># Humanos infecciosos </span></span>
<span>  <span class="va">Rh</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>    <span class="co"># Humanos recuperados</span></span>
<span>  <span class="va">Sv</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>    <span class="co"># Vectores susceptibles</span></span>
<span>  <span class="va">Ev</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>    <span class="co"># Vectores expuestos</span></span>
<span>  <span class="va">Iv</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>    <span class="co"># Vectores infecciosos</span></span>
<span>  </span>
<span>  <span class="fu">with</span><span class="op">(</span><span class="fu">as.list</span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, <span class="co"># entorno local para evaluar derivados</span></span>
<span>       <span class="op">{</span></span>
<span>         <span class="co"># Humanos</span></span>
<span>         <span class="va">dSh</span>   <span class="op">&lt;-</span>  <span class="va">PAR</span> <span class="op">*</span> <span class="va">Nh</span> <span class="op">-</span> <span class="va">PAR</span> <span class="op">*</span> <span class="op">(</span><span class="va">Iv</span><span class="op">/</span><span class="va">Nh</span><span class="op">)</span> <span class="op">*</span> <span class="va">Sh</span> <span class="op">-</span> <span class="va">PAR</span> <span class="op">*</span> <span class="va">Sh</span>   </span>
<span>         <span class="va">dIh</span>   <span class="op">&lt;-</span>  <span class="va">PAR</span> <span class="op">*</span> <span class="op">(</span><span class="va">Iv</span><span class="op">/</span><span class="va">Nh</span><span class="op">)</span> <span class="op">*</span> <span class="va">Sh</span> <span class="op">-</span> <span class="op">(</span><span class="va">PAR</span> <span class="op">+</span> <span class="va">PAR</span><span class="op">)</span> <span class="op">*</span> <span class="va">Ih</span></span>
<span>         <span class="va">dRh</span>   <span class="op">&lt;-</span>  <span class="va">PAR</span> <span class="op">*</span> <span class="va">Ih</span>  <span class="op">-</span> <span class="va">PAR</span> <span class="op">*</span> <span class="va">Rh</span></span>
<span>         </span>
<span>         <span class="co"># Vectores</span></span>
<span>         <span class="va">dSv</span>  <span class="op">&lt;-</span>  <span class="va">alphav</span> <span class="op">*</span> <span class="va">Nv</span> <span class="op">-</span> <span class="va">PAR</span> <span class="op">*</span> <span class="op">(</span><span class="va">Ih</span><span class="op">/</span><span class="va">Nh</span><span class="op">)</span> <span class="op">*</span> <span class="va">Sv</span> <span class="op">-</span> <span class="va">PAR</span> <span class="op">*</span> <span class="va">Sv</span> </span>
<span>         <span class="va">dEv</span>  <span class="op">&lt;-</span>  <span class="va">PAR</span> <span class="op">*</span> <span class="op">(</span><span class="va">Ih</span><span class="op">/</span><span class="va">Nh</span><span class="op">)</span> <span class="op">*</span> <span class="va">Sv</span> <span class="op">-</span> <span class="op">(</span><span class="va">PAR</span> <span class="op">+</span> <span class="va">PAR</span><span class="op">)</span><span class="op">*</span> <span class="va">Ev</span></span>
<span>         <span class="va">dIv</span>  <span class="op">&lt;-</span>  <span class="va">PAR</span> <span class="op">*</span> <span class="va">Ev</span> <span class="op">-</span> <span class="va">PAR</span> <span class="op">*</span> <span class="va">Iv</span></span>
<span>         </span>
<span>         <span class="va">dx</span>   <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">dSh</span>, <span class="va">dIh</span>, <span class="va">dRh</span>, <span class="va">dSv</span>, <span class="va">dEv</span>, <span class="va">dIv</span><span class="op">)</span></span>
<span>         <span class="fu">list</span><span class="op">(</span><span class="va">dx</span><span class="op">)</span></span>
<span>       <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>

</section><section id="resuelva-el-sistema"><h2 class="section-heading">10. Resuelva el Sistema<a class="anchor" aria-label="anchor" href="#resuelva-el-sistema"></a>
</h2>
<hr class="half-width">
<p>En esta sección se crearán los tres argumentos faltantes para usar la
función <code>ode</code> y se creará un objeto de clase
<code>data.frame</code> con los resultados de la función
<code>ode</code>. Por favor complete y comente el código para:</p>
<ul>
<li><p>Los VALORES de las condiciones iniciales del sistema.</p></li>
<li><p>Los ARGUMENTOS de la función <strong><code>ode</code></strong> en
el paquete <strong>deSolve</strong>.</p></li>
</ul>
<div id="desafío-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-3" class="callout-inner">
<h3 class="callout-title">Desafío 3<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo-3"></a>
</h3>
<div class="callout-content">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Secuencia temporal (times)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>times  <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">365</span> <span class="sc">*</span> TIME , <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Los parámetros (parms)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">muv      =</span> muv,     </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">muh      =</span> muh, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">alphav   =</span> alphav,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">alphah   =</span> alphah,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma    =</span> gamma,   </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">delta    =</span> delta,   </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">betav    =</span> betav,       </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">betah    =</span> betah,   </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Nh       =</span> Nh,      </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Nv       =</span> Nv</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Condiciones iniciales del sistema (y)</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>xstart <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Sh =</span> VALOR?,        <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">Ih =</span> VALOR?,        <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">Rh =</span> VALOR?,        <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">Sv =</span> VALOR?,        <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">Ev =</span> VALOR?,        <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">Iv =</span> VALOR?)        <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Resuelva las ecuaciones</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">ode</span>(<span class="at">y      =</span> ARGUMENTO?,   <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">times  =</span> ARGUMENTO?,   <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fun    =</span> ARGUMENTO?,   <span class="co"># COMPLETE Y COMENTE</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">parms  =</span> ARGUMENTO?))  <span class="co"># COMPLETE Y COMENTE</span></span></code></pre>
</div>
</div>
</div>
</div>

</section><section id="resultados"><h2 class="section-heading">11. Resultados<a class="anchor" aria-label="anchor" href="#resultados"></a>
</h2>
<hr class="half-width">
<div id="desafío-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="desafío-4" class="callout-inner">
<h3 class="callout-title">Desafío 4<a class="anchor" aria-label="anchor" href="#desaf%C3%ADo-4"></a>
</h3>
<div class="callout-content">
<p>Para tener una visualización más significativa de los resultados,
convierta las unidades de tiempo de <em>días</em> a <em>años</em> y a
<em>semanas</em>.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cree las opciones de tiempo para años y semanas </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>years <span class="ot">&lt;-</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>weeks <span class="ot">&lt;-</span> </span></code></pre>
</div>
</div>
</div>
</div>

<p>Observe el comportamiento del modelo en distintas escalas de tiempo
(semanas y años):</p>
<div class="section level3">
<h3 id="comportamiento-general-población-humana">11.1 Comportamiento General (Población humana)<a class="anchor" aria-label="anchor" href="#comportamiento-general-poblaci%C3%B3n-humana"></a>
</h3>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Revise el comportamiento general del modelo para 100 años</span></span>
<span><span class="va">p1h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="va">Rh</span> <span class="op">+</span> <span class="va">Ih</span> <span class="op">+</span> <span class="va">Sh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'grey68'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana total'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="va">p2h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Sh</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'royalblue'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana susceptible'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="va">p3h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ih</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'firebrick'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana infecciosa'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="va">p4h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Rh</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'olivedrab'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana recuperada'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1h</span>, <span class="va">p2h</span>, <span class="va">p3h</span>, <span class="va">p4h</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/ZIKAB-rendered-p1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="comportamiento-general-población-de-vectores">11.2 Comportamiento General (Población de vectores)<a class="anchor" aria-label="anchor" href="#comportamiento-general-poblaci%C3%B3n-de-vectores"></a>
</h3>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Revise el comportamiento general del modelo</span></span>
<span><span class="va">p1v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="va">Sv</span> <span class="op">+</span> <span class="va">Ev</span> <span class="op">+</span> <span class="va">Iv</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'grey68'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población total de mosquitos'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="va">p2v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Sv</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'royalblue'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población susceptible de mosquitos'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="va">p3v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ev</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'orchid'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población expuesta de mosquitos'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="va">p4v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Iv</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'firebrick'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población infecciosa de mosquitos'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1v</span>, <span class="va">p2v</span>, <span class="va">p3v</span>, <span class="va">p4v</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/ZIKAB-rendered-p2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="proporción">11.3 Proporción<a class="anchor" aria-label="anchor" href="#proporci%C3%B3n"></a>
</h3>
<p>Por favor dé una mirada más cuidadosa a las proporciones y
discútalas</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Sh</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'royalblue'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana susceptible'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Proporción'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ih</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'firebrick'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana infecciosa'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Proporción'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Rh</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'olivedrab'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana recuperada'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Proporción'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Años'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/ZIKAB-rendered-p3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="la-primera-epidemia">11.4 La primera epidemia<a class="anchor" aria-label="anchor" href="#la-primera-epidemia"></a>
</h3>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Revise la primera epidemia</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">out</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">weeks</span> <span class="op">&lt;</span> <span class="fl">54</span><span class="op">)</span></span>
<span><span class="va">p1e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ih</span>, x <span class="op">=</span> <span class="va">weeks</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'firebrick'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población de humanos infecciosos'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Semanas'</span><span class="op">)</span></span>
<span><span class="va">p2e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Rh</span>, x <span class="op">=</span> <span class="va">weeks</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'olivedrab'</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Población humana recuperada'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">'Número'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">'Semanas'</span><span class="op">)</span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1e</span>, <span class="va">p2e</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/ZIKAB-rendered-p4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="algunos-aspectos-por-discutir">11.5 Algunos aspectos por discutir<a class="anchor" aria-label="anchor" href="#algunos-aspectos-por-discutir"></a>
</h3>
<ul>
<li>¿Qué tan sensible es el modelo a cambios en el <span class="math inline">\(R_0\)</span>?</li>
<li>¿Qué razones hay (según el modelo) para el intervalo de tiempo entre
estas epidemias simuladas?</li>
<li>¿Cómo se puede calcular la tasa de ataque?</li>
</ul>
</div>
<div class="section level3">
<h3 id="modele-una-o-más-intervenciones-de-control">11.6 Modele una o más intervenciones de control<a class="anchor" aria-label="anchor" href="#modele-una-o-m%C3%A1s-intervenciones-de-control"></a>
</h3>
<p>Ahora, utilizando este modelo básico, modelar por grupos el impacto
de las siguientes intervenciones:</p>
<ol style="list-style-type: decimal">
<li>Grupo 1. Fumigación contra mosquitos</li>
<li>Grupo 2. Mosquiteros/angeos</li>
<li>Grupo 3. Vacunación que previene frente a infecciones</li>
</ol>
<p>Para cada intervención:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Indique en qué parte del modelo haría los cambios.</p></li>
<li><p>De acuerdo a la literatura que explique estas intervenciones y
describa cómo parametrizará el modelo. ¿Todas estas intervenciones son
viables en la actualidad?</p></li>
</ol>
</div>
</section><section id="sobre-este-documento"><h2 class="section-heading">Sobre este documento<a class="anchor" aria-label="anchor" href="#sobre-este-documento"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="contribuciones">Contribuciones<a class="anchor" aria-label="anchor" href="#contribuciones"></a>
</h3>
<ul>
<li>Zulma Cucunuba &amp; Pierre Nouvellet: Versión inicial</li>
<li>Kelly Charinga &amp; Zhian N. Kamvar: Edición</li>
<li>José M. Velasco-España: Traducción de Inglés a Español y
Edición</li>
<li>Andree Valle-Campos: Ediciones menores</li>
</ul>
<p>Contribuciones son bienvenidas vía <a href="https://github.com/reconhub/learn/pulls" class="external-link">pull requests</a>. El
archivo fuente del documento original puede ser encontrado <a href="https://raw.githubusercontent.com/reconhub/learn/master/content/post/practical-vbd.Rmd" class="external-link"><strong>aquí</strong></a>.</p>
</div>
<div class="section level3">
<h3 id="asuntos-legales">Asuntos legales<a class="anchor" aria-label="anchor" href="#asuntos-legales"></a>
</h3>
<p><strong>Licencia</strong>: <a href="https://creativecommons.org/licenses/by/3.0/" class="external-link">CC-BY</a>
<strong>Copyright</strong>: Zulma Cucunuba &amp; Pierre Nouvellet,
2017</p>
<!-- ## Referencias -->
<div id="puntos-clave" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div id="puntos-clave" class="callout-inner">
<h3 class="callout-title">Puntos clave<a class="anchor" aria-label="anchor" href="#puntos-clave"></a>
</h3>
<div class="callout-content">
<p>Revise si al final de esta lección adquirió estas competencias:</p>
<ul>
<li>Aplicar conceptos como parámetros, <span class="math inline">\(R_0\)</span> e inmunidad de rebaño, aprendidos en
la sesión A del taller</li>
<li>Traducir fórmulas matemáticas de las interacciones entre los
parámetros del modelo a código de R</li>
<li>Realizar un modelo simple en R para una enfermedad transmitida por
vector</li>
<li>Discutir cambios en las proyecciones del modelo cuando se instauran
diferentes estrategias de control de la infección</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</section></section><section id="aio-EnfermedadX"><p>Content from <a href="EnfermedadX.html">Taller Día 4 - Grupo 1 Estimación de las distribuciones de rezagos epidemiológicos: Enfermedad X</a></p>
<hr>
<p> Last updated on 2023-12-03 | 
        
        <a href="https://github.com/Joskerus/Nuevoformato/edit/main/episodes/EnfermedadX.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>¿Cómo responder ante un brote de una enfermedad desconocida?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<p>Al final de este taller usted podrá:</p>
<ul>
<li><p>Comprender los conceptos clave de las distribuciones de rezagos
epidemiológicos para la Enfermedad X.</p></li>
<li><p>Comprender las estructuras de datos y las herramientas para el
análisis de datos de rastreo de contactos.</p></li>
<li><p>Aprender a ajustar las estimaciones del intervalo serial y el
período de incubación de la Enfermedad X teniendo en cuenta la censura
por intervalo utilizando un marco de trabajo Bayesiano.</p></li>
<li><p>Aprender a utilizar estos parámetros para informar estrategias de
control en un brote de un patógeno desconocido.</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="introducción"><h2 class="section-heading">1. Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>La Enfermedad X representa un hipotético, pero plausible, brote de
una enfermedad infecciosa en el futuro. Este término fue acuñado por la
Organización Mundial de la Salud (OMS) y sirve como un término general
para un patógeno desconocido que podría causar una epidemia grave a
nivel internacional. Este concepto representa la naturaleza impredecible
de la aparición de enfermedades infecciosas y resalta la necesidad de
una preparación global y mecanismos de respuesta rápida. La Enfermedad X
simboliza el potencial de una enfermedad inesperada y de rápida
propagación, y resalta la necesidad de sistemas de salud flexibles y
adaptables, así como capacidades de investigación para identificar,
comprender y combatir patógenos desconocidos.</p>
<p>En esta práctica, va a aprender a estimar los rezagos
epidemiológicos, el tiempo entre dos eventos epidemiológicos, utilizando
un conjunto de datos simulado de la Enfermedad X.</p>
<p>La Enfermedad X es causada por un patógeno desconocido y se transmite
directamente de persona a persona. Específicamente, la practica se
centrará en estimar el período de incubación y el intervalo serial.</p>
</section><section id="agenda"><h2 class="section-heading">2. Agenda<a class="anchor" aria-label="anchor" href="#agenda"></a>
</h2>
<hr class="half-width">
<p>Parte 1. Individual o en grupo.</p>
<p>Parte 2. En 5 grupos de 8 personas. Construir estrategia de rastreo
de contactos y aislamiento y preparar presentación de máximo 10
mins.</p>
</section><section id="conceptos-claves"><h2 class="section-heading">3. Conceptos claves<a class="anchor" aria-label="anchor" href="#conceptos-claves"></a>
</h2>
<hr class="half-width">
<div class="section level4">
<h4 id="rezagos-epidemiológicos-período-de-incubación-e-intervalo-serial">
<strong>3.1. Rezagos epidemiológicos: Período de incubación e
intervalo serial</strong><a class="anchor" aria-label="anchor" href="#rezagos-epidemiol%C3%B3gicos-per%C3%ADodo-de-incubaci%C3%B3n-e-intervalo-serial"></a>
</h4>
<p>En epidemiología, las distribuciones de rezagos se refieren a los
<em>retrasos temporales</em> entre dos eventos clave durante un brote.
Por ejemplo: el tiempo entre el inicio de los síntomas y el diagnóstico,
el tiempo entre la aparición de síntomas y la muerte, entre muchos
otros.</p>
<p>Este taller se enfocará en dos rezagos clave conocidos como el
período de incubación y el intervalo serial. Ambos son cruciales para
informar la respuesta de salud pública.</p>
<p>El <u><strong>período de incubación</strong></u> es el tiempo entre
la infección y la aparición de síntomas.</p>
<p>El <u><strong>intervalo serial</strong></u> es el tiempo entre la
aparición de síntomas entre el caso primario y secundario.</p>
<p>La relación entre estos parámetros tiene un impacto en si la
enfermedad se transmite antes <u>(<strong>transmisión
pre-sintomática</strong>)</u> o después de que los síntomas
<u>(<strong>transmisión sintomática</strong>)</u> se hayan desarrollado
en el caso primario (Figura 1).</p>
<figure><img src="practicalfig.jpg" class="figure mx-auto d-block"></figure><p>Figura 1. Relación entre el período de incubación y el intervalo
serial en el momento de la transmisión (<em>Adaptado de Nishiura et
al. 2020)</em></p>
</div>
<div class="section level4">
<h4 id="distribuciones-comunes-de-rezagos-y-posibles-sesgos">3.2. Distribuciones comunes de rezagos y posibles sesgos<a class="anchor" aria-label="anchor" href="#distribuciones-comunes-de-rezagos-y-posibles-sesgos"></a>
</h4>
<div class="section level5">
<h5 id="sesgos-potenciales">
<strong>3.2.1 Sesgos potenciales</strong><a class="anchor" aria-label="anchor" href="#sesgos-potenciales"></a>
</h5>
<p>Cuando se estiman rezagos epidemiológicos, es importante considerar
posibles sesgos:</p>
<p><u><strong>Censura</strong></u> significa que sabemos que un evento
ocurrió, pero no sabemos exactamente cuándo sucedió. La mayoría de los
datos epidemiológicos están “doblemente censurados” debido a la
incertidumbre que rodea tanto los tiempos de eventos primarios como
secundarios. No tener en cuenta la censura puede llevar a estimaciones
sesgadas de la desviación estándar del resago (Park et al. en
progreso).</p>
<p><u><strong>Truncamiento a la derecha</strong></u> es un tipo de sesgo
de muestreo relacionado con el proceso de recolección de datos. Surge
porque solo se pueden observar los casos que han sido reportados. No
tener en cuenta el truncamiento a la derecha durante la fase de
crecimiento de una epidemia puede llevar a una subestimación del rezago
medio (Park et al. en progreso).</p>
<p>El sesgo <u><strong>dinámico (o de fase epidémica</strong>)</u> es
otro tipo de sesgo de muestreo. Afecta a los datos retrospectivos y está
relacionado con la fase de la epidemia: durante la fase de crecimiento
exponencial, los casos que desarrollaron síntomas recientemente están
sobrerrepresentados en los datos observados, mientras que durante la
fase de declive, estos casos están subrepresentados, lo que lleva a la
estimación de intervalos de retraso más cortos y más largos,
respectivamente (Park et al. en progreso).</p>
</div>
<div class="section level5">
<h5 id="distribuciones-de-rezagos">
<strong>3.2.2 Distribuciones de rezagos</strong><a class="anchor" aria-label="anchor" href="#distribuciones-de-rezagos"></a>
</h5>
<p>Tres distribuciones de probabilidad comunes utilizadas para
caracterizar rezagos en epidemiología de enfermedades infecciosas (Tabla
1):</p>
<table style="width:82%;" class="table">
<caption>Tabla 1. Tres de las distribuciones de probabilidad más comunes
para rezagos epidemiológicos.</caption>
<colgroup>
<col width="23%">
<col width="58%">
</colgroup>
<thead><tr class="header">
<th>Distribución</th>
<th align="center">Parámetros</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Weibull</strong></td>
<td align="center">
<code>shape</code> y <code>scale</code>
</td>
</tr>
<tr class="even">
<td><strong>gamma</strong></td>
<td align="center">
<code>shape</code> y <code>scale</code>
</td>
</tr>
<tr class="odd">
<td><strong>log normal</strong></td>
<td align="center">
<code>log mean</code> y
<code>log standard deviation</code>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="paquetes-de-r-para-la-practica"><h2 class="section-heading">4. Paquetes de <em>R</em> para la practica<a class="anchor" aria-label="anchor" href="#paquetes-de-r-para-la-practica"></a>
</h2>
<hr class="half-width">
<p>En esta practica se usarán los siguientes paquetes de
<code>R</code>:</p>
<ul>
<li><p><code>dplyr</code> para manejo de datos</p></li>
<li><p><code>epicontacts</code> para visualizar los datos de rastreo de
contactos</p></li>
<li><p><code>ggplot2</code> y <code>patchwork</code> para
gráficar</p></li>
<li><p><code>incidence</code> para visualizar curvas epidemicas</p></li>
<li><p><code>rstan</code> para estimar el período de incubación</p></li>
<li><p><code>coarseDataTools</code> via <code>EpiEstim</code> para
estimar el intervalo serial</p></li>
</ul>
<p>Instrucciones de instalación para los paquetes:</p>
<p>Para cargar los paquetes, escriba:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epicontacts</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">incidence</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">coarseDataTools</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">EpiEstim</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">loo</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">patchwork</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">rstan</span><span class="op">)</span></span></code></pre>
</div>
</section><section id="datos"><h2 class="section-heading">5. Datos<a class="anchor" aria-label="anchor" href="#datos"></a>
</h2>
<hr class="half-width">
<p>Esta práctica está partida en dos grupos para abordar dos
enfermedades desconocidas con diferentes modos de transmisión.</p>
<p>Cargue los datos simulados, que están guardados como un archivo
.RDS.</p>
<p>Hay dos elementos de interés:</p>
<ul>
<li><p><code>linelist</code>, un archivo que contiene una lista de casos
de la Enfermedad X, un caso por fila.</p></li>
<li><p><code>contacts</code>, un archivo con datos de rastreo de
contactos que contiene información sobre pares de casos primarios y
secundarios.</p></li>
</ul></section><section id="exploración-de-los-datos"><h2 class="section-heading">6. Exploración de los datos<a class="anchor" aria-label="anchor" href="#exploraci%C3%B3n-de-los-datos"></a>
</h2>
<hr class="half-width">
<div class="section level4">
<h4 id="exploración-de-los-datos-en-linelist">
<strong>6.1. Exploración de los datos en
<code>linelist</code></strong><a class="anchor" aria-label="anchor" href="#exploraci%C3%B3n-de-los-datos-en-linelist"></a>
</h4>
<p>Empiece con <code>linelist</code>. Estos datos fueron recolectado
como parte de la vigilancia epidemiológica rutinaria. Cada fila
representa un caso de la Enfermedad X, y hay 7 variables:</p>
<ul>
<li><p><code>id</code>: número único de identificación del caso</p></li>
<li><p><code>date_onset</code>: fecha de inicio de los síntomas del
paciente</p></li>
<li><p><code>sex</code>: : M = masculino; F = femenino</p></li>
<li><p><code>age</code>: edad del paciente en años</p></li>
<li><p><code>exposure</code>: información sobre cómo el paciente podría
haber estado expuesto</p></li>
<li><p><code>exposure_start</code>: primera fecha en que el paciente
estuvo expuesto</p></li>
<li><p><code>exposure_end</code>: última fecha en que el paciente estuvo
expuesto</p></li>
</ul>
<div class="alert alert-secondary">
<p><em>💡 <strong>Preguntas (1)</strong></em></p>
<ul>
<li><p><em>¿Cuántos casos hay en los datos de
<code>linelist</code>?</em></p></li>
<li><p><em>¿Qué proporción de los casos son femeninos?</em></p></li>
<li><p><em>¿Cuál es la distribución de edades de los
casos?</em></p></li>
<li><p><em>¿Qué tipo de información sobre la exposición está
disponible?</em></p></li>
</ul>
</div>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Inspecionar los datos</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  id date_onset sex age                    exposure exposure_start exposure_end
1  1 2023-10-01   M  34 Close, skin-to-skin contact           &lt;NA&gt;         &lt;NA&gt;
2  2 2023-10-03   F  38 Close, skin-to-skin contact     2023-09-29   2023-09-29
3  3 2023-10-06   F  38 Close, skin-to-skin contact     2023-09-28   2023-09-28
4  4 2023-10-10   F  37                        &lt;NA&gt;     2023-09-25   2023-09-27
5  5 2023-10-11   F  33                        &lt;NA&gt;     2023-10-05   2023-10-05
6  6 2023-10-12   F  34 Close, skin-to-skin contact     2023-10-10   2023-10-10</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P1</span></span>
<span><span class="fu">nrow</span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 166</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P2</span></span>
<span><span class="fu">table</span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="fu">nrow</span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>        <span class="va">M</span> </span>
<span><span class="fl">0.6144578</span> </span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P3</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  22.00   33.00   36.00   35.51   38.00   47.00 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P4</span></span>
<span><span class="fu">table</span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">exposure</span>, exclude <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fu">nrow</span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Close, skin-to-skin contact 
                  0.6626506 </code></pre>
</div>
<div class="alert alert-secondary">
<p><em>💡 <strong>Discusión</strong></em></p>
<ul>
<li><p>¿Por qué cree que falta la información de exposición en algunos
casos?</p></li>
<li><p>Ahora, grafique la curva epidémica. ¿En qué parte del brote cree
que está (principio, medio, final)?</p></li>
</ul>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu">incidence</span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">date_onset</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/EnfermedadX-rendered-epi%20curve-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Parece que la epidemía todavía podría esta creciendo.</p>
</div>
<div class="section level4">
<h4 id="exploración-de-los-datos-de-rastreo-de-contactos">
<strong>6.2. Exploración de los datos de
<code>rastreo de contactos</code></strong><a class="anchor" aria-label="anchor" href="#exploraci%C3%B3n-de-los-datos-de-rastreo-de-contactos"></a>
</h4>
<p>Ahora vea los datos de rastreo de contactos, que se obtuvieron a
través de entrevistas a los pacientes. A los pacientes se les preguntó
sobre actividades e interacciones recientes para identificar posibles
fuentes de infección. Se emparejaron pares de casos primarios y
secundarios si el caso secundario nombraba al caso primario como un
contacto. Solo hay información de un subconjunto de los casos porque no
todos los pacientes pudieron ser contactados para una entrevista.</p>
<p>Note que para este ejercicio, se asumirá que los casos secundarios
solo tenían un posible infectante. En realidad, la posibilidad de que un
caso tenga múltiples posibles infectantes necesita ser evaluada.</p>
<p>Los datos de rastreo de contactos tienen 4 variables:</p>
<ul>
<li><p><code>primary_case_id</code>: número de identificación único para
el caso primario (infectante)</p></li>
<li><p><code>secondary_case_id</code>: número de identificación único
para el caso secundario (infectado)</p></li>
<li><p><code>primary_onset_date</code>: fecha de inicio de síntomas del
caso primario</p></li>
<li><p><code>secondary_onset_date</code>: fecha de inicio de síntomas
del caso secundario</p></li>
</ul>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">make_epicontacts</span><span class="op">(</span>linelist <span class="op">=</span> <span class="va">linelist</span>,</span>
<span>                       contacts <span class="op">=</span> <span class="va">contacts</span>,</span>
<span>                       from <span class="op">=</span> <span class="st">"primary_case_id"</span>,</span>
<span>                       to <span class="op">=</span> <span class="st">"secondary_case_id"</span>,</span>
<span>                       directed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Esto indica que los contactos son directos (i.e., este gráfico traza una flecha desde los casos primarios a los secundarios)</span></span>
<span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<!--html_preserve-->
<div id="htmlwidget-be318a6d67ce3cae5f0a" class="visNetwork html-widget" style="width:90%;height:700px;">

</div>
<script type="application/json" data-for="htmlwidget-be318a6d67ce3cae5f0a">{"x":{"nodes":{"id":[1,2,4,5,6,8,9,10,11,12,15,16,19,21,22,23,25,28,29,30,31,32,33,34,36,37,38,41,42,43,44,45,46,47,51,52,53,54,55,57,59,60,61,63,64,65,66,68,69,70,71,73,74,78,79,80,81,83,86,88,89,90,92,96,98,99,100,102,103,105,106,107,108,111,113,114,115,117,119,120,121,122,125,127,128,129,133,136,138,141,142,144,149,152,153,154,156,158,159,160,161,162,164,165,166],"date_onset":["2023-10-01","2023-10-03","2023-10-10","2023-10-11","2023-10-12","2023-10-13","2023-10-15","2023-10-16","2023-10-16","2023-10-18","2023-10-20","2023-10-21","2023-10-24","2023-10-24","2023-10-25","2023-10-26","2023-10-28","2023-10-30","2023-10-30","2023-10-30","2023-10-31","2023-11-03","2023-11-03","2023-11-03","2023-11-04","2023-11-04","2023-11-05","2023-11-06","2023-11-06","2023-11-06","2023-11-06","2023-11-07","2023-11-07","2023-11-07","2023-11-08","2023-11-09","2023-11-10","2023-11-10","2023-11-10","2023-11-11","2023-11-12","2023-11-12","2023-11-12","2023-11-12","2023-11-13","2023-11-13","2023-11-13","2023-11-14","2023-11-14","2023-11-14","2023-11-14","2023-11-15","2023-11-15","2023-11-16","2023-11-16","2023-11-16","2023-11-16","2023-11-17","2023-11-17","2023-11-18","2023-11-18","2023-11-18","2023-11-18","2023-11-20","2023-11-20","2023-11-20","2023-11-20","2023-11-20","2023-11-21","2023-11-21","2023-11-21","2023-11-21","2023-11-22","2023-11-22","2023-11-23","2023-11-23","2023-11-23","2023-11-24","2023-11-25","2023-11-25","2023-11-25","2023-11-25","2023-11-26","2023-11-26","2023-11-26","2023-11-26","2023-11-26","2023-11-27","2023-11-27","2023-11-27","2023-11-27","2023-11-28","2023-11-29","2023-11-29","2023-11-29","2023-11-29","2023-11-29","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30"],"sex":["M","F","F","F","F","M","F","M","F","M","M","F","M","M","M","M","M","F","F","M","M","M","M","M","F","M","M","F","F","M","F","M","M","F","M","M","F","M","M","M","M","F","F","M","M","M","F","M","M","F","M","M","F","M","M","F","F","M","F","M","M","F","F","M","M","M","F","F","M","M","M","M","M","F","F","M","M","F","M","F","F","F","M","M","M","M","M","M","F","M","F","M","F","M","M","F","F","F","M","F","M","F","M","M","F"],"age":[34,38,37,33,34,35,36,42,39,33,39,39,33,33,32,36,36,34,32,31,38,35,38,30,38,35,34,38,42,35,32,29,32,36,38,28,34,34,27,33,41,38,35,37,42,36,37,33,35,42,31,40,34,32,34,33,34,37,34,42,35,34,41,36,24,35,39,39,43,33,38,34,33,37,37,37,31,27,38,36,38,36,39,31,37,33,37,34,39,40,36,47,34,36,31,22,35,35,37,31,38,38,40,37,36],"exposure":["Close, skin-to-skin contact","Close, skin-to-skin contact",null,null,"Close, skin-to-skin contact",null,null,null,"Close, skin-to-skin contact",null,null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact",null,null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact",null,null,null,"Close, skin-to-skin contact","Close, skin-to-skin contact",null,null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact",null,null,null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact",null,"Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact","Close, skin-to-skin contact",null,"Close, skin-to-skin contact","Close, skin-to-skin contact",null,null,null,"Close, skin-to-skin contact"],"exposure_start":[null,"2023-09-29","2023-09-25","2023-10-05","2023-10-10","2023-10-08","2023-10-13","2023-10-04","2023-10-03","2023-10-11","2023-10-13","2023-10-19","2023-10-20","2023-10-05","2023-10-20","2023-10-14","2023-10-26","2023-10-27","2023-10-24","2023-10-17","2023-10-30","2023-11-02","2023-10-27","2023-10-30","2023-10-29","2023-10-25","2023-11-01","2023-11-03","2023-11-03","2023-11-01","2023-11-03","2023-11-05","2023-10-18","2023-10-30","2023-11-02",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"exposure_end":[null,"2023-09-29","2023-09-27","2023-10-05","2023-10-10","2023-10-08","2023-10-13","2023-10-04","2023-10-03","2023-10-11","2023-10-14","2023-10-20","2023-10-20","2023-10-05","2023-10-20","2023-10-15","2023-10-26","2023-10-27","2023-10-25","2023-10-17","2023-10-30","2023-11-02","2023-10-27","2023-10-30","2023-10-30","2023-10-25","2023-11-01","2023-11-03","2023-11-03","2023-11-03","2023-11-04","2023-11-05","2023-10-19","2023-10-30","2023-11-04",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"label":["1","2","4","5","6","8","9","10","11","12","15","16","19","21","22","23","25","28","29","30","31","32","33","34","36","37","38","41","42","43","44","45","46","47","51","52","53","54","55","57","59","60","61","63","64","65","66","68","69","70","71","73","74","78","79","80","81","83","86","88","89","90","92","96","98","99","100","102","103","105","106","107","108","111","113","114","115","117","119","120","121","122","125","127","128","129","133","136","138","141","142","144","149","152","153","154","156","158","159","160","161","162","164","165","166"],"title":["<p> id: 1<br>date_onset: 2023-10-01<br>sex: M<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 2<br>date_onset: 2023-10-03<br>sex: F<br>age: 38<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-09-29<br>exposure_end: 2023-09-29 <\/p>","<p> id: 4<br>date_onset: 2023-10-10<br>sex: F<br>age: 37<br>exposure: NA<br>exposure_start: 2023-09-25<br>exposure_end: 2023-09-27 <\/p>","<p> id: 5<br>date_onset: 2023-10-11<br>sex: F<br>age: 33<br>exposure: NA<br>exposure_start: 2023-10-05<br>exposure_end: 2023-10-05 <\/p>","<p> id: 6<br>date_onset: 2023-10-12<br>sex: F<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-10<br>exposure_end: 2023-10-10 <\/p>","<p> id: 8<br>date_onset: 2023-10-13<br>sex: M<br>age: 35<br>exposure: NA<br>exposure_start: 2023-10-08<br>exposure_end: 2023-10-08 <\/p>","<p> id: 9<br>date_onset: 2023-10-15<br>sex: F<br>age: 36<br>exposure: NA<br>exposure_start: 2023-10-13<br>exposure_end: 2023-10-13 <\/p>","<p> id: 10<br>date_onset: 2023-10-16<br>sex: M<br>age: 42<br>exposure: NA<br>exposure_start: 2023-10-04<br>exposure_end: 2023-10-04 <\/p>","<p> id: 11<br>date_onset: 2023-10-16<br>sex: F<br>age: 39<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-03<br>exposure_end: 2023-10-03 <\/p>","<p> id: 12<br>date_onset: 2023-10-18<br>sex: M<br>age: 33<br>exposure: NA<br>exposure_start: 2023-10-11<br>exposure_end: 2023-10-11 <\/p>","<p> id: 15<br>date_onset: 2023-10-20<br>sex: M<br>age: 39<br>exposure: NA<br>exposure_start: 2023-10-13<br>exposure_end: 2023-10-14 <\/p>","<p> id: 16<br>date_onset: 2023-10-21<br>sex: F<br>age: 39<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-19<br>exposure_end: 2023-10-20 <\/p>","<p> id: 19<br>date_onset: 2023-10-24<br>sex: M<br>age: 33<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-20<br>exposure_end: 2023-10-20 <\/p>","<p> id: 21<br>date_onset: 2023-10-24<br>sex: M<br>age: 33<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-05<br>exposure_end: 2023-10-05 <\/p>","<p> id: 22<br>date_onset: 2023-10-25<br>sex: M<br>age: 32<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-20<br>exposure_end: 2023-10-20 <\/p>","<p> id: 23<br>date_onset: 2023-10-26<br>sex: M<br>age: 36<br>exposure: NA<br>exposure_start: 2023-10-14<br>exposure_end: 2023-10-15 <\/p>","<p> id: 25<br>date_onset: 2023-10-28<br>sex: M<br>age: 36<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-26<br>exposure_end: 2023-10-26 <\/p>","<p> id: 28<br>date_onset: 2023-10-30<br>sex: F<br>age: 34<br>exposure: NA<br>exposure_start: 2023-10-27<br>exposure_end: 2023-10-27 <\/p>","<p> id: 29<br>date_onset: 2023-10-30<br>sex: F<br>age: 32<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-24<br>exposure_end: 2023-10-25 <\/p>","<p> id: 30<br>date_onset: 2023-10-30<br>sex: M<br>age: 31<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-17<br>exposure_end: 2023-10-17 <\/p>","<p> id: 31<br>date_onset: 2023-10-31<br>sex: M<br>age: 38<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-30<br>exposure_end: 2023-10-30 <\/p>","<p> id: 32<br>date_onset: 2023-11-03<br>sex: M<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-11-02<br>exposure_end: 2023-11-02 <\/p>","<p> id: 33<br>date_onset: 2023-11-03<br>sex: M<br>age: 38<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-27<br>exposure_end: 2023-10-27 <\/p>","<p> id: 34<br>date_onset: 2023-11-03<br>sex: M<br>age: 30<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-30<br>exposure_end: 2023-10-30 <\/p>","<p> id: 36<br>date_onset: 2023-11-04<br>sex: F<br>age: 38<br>exposure: NA<br>exposure_start: 2023-10-29<br>exposure_end: 2023-10-30 <\/p>","<p> id: 37<br>date_onset: 2023-11-04<br>sex: M<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-25<br>exposure_end: 2023-10-25 <\/p>","<p> id: 38<br>date_onset: 2023-11-05<br>sex: M<br>age: 34<br>exposure: NA<br>exposure_start: 2023-11-01<br>exposure_end: 2023-11-01 <\/p>","<p> id: 41<br>date_onset: 2023-11-06<br>sex: F<br>age: 38<br>exposure: NA<br>exposure_start: 2023-11-03<br>exposure_end: 2023-11-03 <\/p>","<p> id: 42<br>date_onset: 2023-11-06<br>sex: F<br>age: 42<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-11-03<br>exposure_end: 2023-11-03 <\/p>","<p> id: 43<br>date_onset: 2023-11-06<br>sex: M<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-11-01<br>exposure_end: 2023-11-03 <\/p>","<p> id: 44<br>date_onset: 2023-11-06<br>sex: F<br>age: 32<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-11-03<br>exposure_end: 2023-11-04 <\/p>","<p> id: 45<br>date_onset: 2023-11-07<br>sex: M<br>age: 29<br>exposure: NA<br>exposure_start: 2023-11-05<br>exposure_end: 2023-11-05 <\/p>","<p> id: 46<br>date_onset: 2023-11-07<br>sex: M<br>age: 32<br>exposure: Close, skin-to-skin contact<br>exposure_start: 2023-10-18<br>exposure_end: 2023-10-19 <\/p>","<p> id: 47<br>date_onset: 2023-11-07<br>sex: F<br>age: 36<br>exposure: NA<br>exposure_start: 2023-10-30<br>exposure_end: 2023-10-30 <\/p>","<p> id: 51<br>date_onset: 2023-11-08<br>sex: M<br>age: 38<br>exposure: NA<br>exposure_start: 2023-11-02<br>exposure_end: 2023-11-04 <\/p>","<p> id: 52<br>date_onset: 2023-11-09<br>sex: M<br>age: 28<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 53<br>date_onset: 2023-11-10<br>sex: F<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 54<br>date_onset: 2023-11-10<br>sex: M<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 55<br>date_onset: 2023-11-10<br>sex: M<br>age: 27<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 57<br>date_onset: 2023-11-11<br>sex: M<br>age: 33<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 59<br>date_onset: 2023-11-12<br>sex: M<br>age: 41<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 60<br>date_onset: 2023-11-12<br>sex: F<br>age: 38<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 61<br>date_onset: 2023-11-12<br>sex: F<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 63<br>date_onset: 2023-11-12<br>sex: M<br>age: 37<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 64<br>date_onset: 2023-11-13<br>sex: M<br>age: 42<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 65<br>date_onset: 2023-11-13<br>sex: M<br>age: 36<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 66<br>date_onset: 2023-11-13<br>sex: F<br>age: 37<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 68<br>date_onset: 2023-11-14<br>sex: M<br>age: 33<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 69<br>date_onset: 2023-11-14<br>sex: M<br>age: 35<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 70<br>date_onset: 2023-11-14<br>sex: F<br>age: 42<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 71<br>date_onset: 2023-11-14<br>sex: M<br>age: 31<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 73<br>date_onset: 2023-11-15<br>sex: M<br>age: 40<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 74<br>date_onset: 2023-11-15<br>sex: F<br>age: 34<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 78<br>date_onset: 2023-11-16<br>sex: M<br>age: 32<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 79<br>date_onset: 2023-11-16<br>sex: M<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 80<br>date_onset: 2023-11-16<br>sex: F<br>age: 33<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 81<br>date_onset: 2023-11-16<br>sex: F<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 83<br>date_onset: 2023-11-17<br>sex: M<br>age: 37<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 86<br>date_onset: 2023-11-17<br>sex: F<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 88<br>date_onset: 2023-11-18<br>sex: M<br>age: 42<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 89<br>date_onset: 2023-11-18<br>sex: M<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 90<br>date_onset: 2023-11-18<br>sex: F<br>age: 34<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 92<br>date_onset: 2023-11-18<br>sex: F<br>age: 41<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 96<br>date_onset: 2023-11-20<br>sex: M<br>age: 36<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 98<br>date_onset: 2023-11-20<br>sex: M<br>age: 24<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 99<br>date_onset: 2023-11-20<br>sex: M<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 100<br>date_onset: 2023-11-20<br>sex: F<br>age: 39<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 102<br>date_onset: 2023-11-20<br>sex: F<br>age: 39<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 103<br>date_onset: 2023-11-21<br>sex: M<br>age: 43<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 105<br>date_onset: 2023-11-21<br>sex: M<br>age: 33<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 106<br>date_onset: 2023-11-21<br>sex: M<br>age: 38<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 107<br>date_onset: 2023-11-21<br>sex: M<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 108<br>date_onset: 2023-11-22<br>sex: M<br>age: 33<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 111<br>date_onset: 2023-11-22<br>sex: F<br>age: 37<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 113<br>date_onset: 2023-11-23<br>sex: F<br>age: 37<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 114<br>date_onset: 2023-11-23<br>sex: M<br>age: 37<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 115<br>date_onset: 2023-11-23<br>sex: M<br>age: 31<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 117<br>date_onset: 2023-11-24<br>sex: F<br>age: 27<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 119<br>date_onset: 2023-11-25<br>sex: M<br>age: 38<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 120<br>date_onset: 2023-11-25<br>sex: F<br>age: 36<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 121<br>date_onset: 2023-11-25<br>sex: F<br>age: 38<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 122<br>date_onset: 2023-11-25<br>sex: F<br>age: 36<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 125<br>date_onset: 2023-11-26<br>sex: M<br>age: 39<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 127<br>date_onset: 2023-11-26<br>sex: M<br>age: 31<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 128<br>date_onset: 2023-11-26<br>sex: M<br>age: 37<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 129<br>date_onset: 2023-11-26<br>sex: M<br>age: 33<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 133<br>date_onset: 2023-11-26<br>sex: M<br>age: 37<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 136<br>date_onset: 2023-11-27<br>sex: M<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 138<br>date_onset: 2023-11-27<br>sex: F<br>age: 39<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 141<br>date_onset: 2023-11-27<br>sex: M<br>age: 40<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 142<br>date_onset: 2023-11-27<br>sex: F<br>age: 36<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 144<br>date_onset: 2023-11-28<br>sex: M<br>age: 47<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 149<br>date_onset: 2023-11-29<br>sex: F<br>age: 34<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 152<br>date_onset: 2023-11-29<br>sex: M<br>age: 36<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 153<br>date_onset: 2023-11-29<br>sex: M<br>age: 31<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 154<br>date_onset: 2023-11-29<br>sex: F<br>age: 22<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 156<br>date_onset: 2023-11-29<br>sex: F<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 158<br>date_onset: 2023-11-30<br>sex: F<br>age: 35<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 159<br>date_onset: 2023-11-30<br>sex: M<br>age: 37<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 160<br>date_onset: 2023-11-30<br>sex: F<br>age: 31<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 161<br>date_onset: 2023-11-30<br>sex: M<br>age: 38<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 162<br>date_onset: 2023-11-30<br>sex: F<br>age: 38<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 164<br>date_onset: 2023-11-30<br>sex: M<br>age: 40<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 165<br>date_onset: 2023-11-30<br>sex: M<br>age: 37<br>exposure: NA<br>exposure_start: NA<br>exposure_end: NA <\/p>","<p> id: 166<br>date_onset: 2023-11-30<br>sex: F<br>age: 36<br>exposure: Close, skin-to-skin contact<br>exposure_start: NA<br>exposure_end: NA <\/p>"],"color.highlight.background":["#CCDDFF","#C4DCF7","#BDDBEF","#B6DAE7","#AFD9E0","#A8D8D8","#A0D7D0","#99D6C9","#92D5C1","#8BD4B9","#84D3B1","#7CD2AA","#7ED0A6","#89CEA7","#95CBA8","#A0C8A9","#ACC6AB","#B8C3AC","#C3C0AD","#CFBEAE","#DABBAF","#E6B8B0","#F2B5B1","#FDB3B2","#F7B1B4","#F0B0B5","#E8AFB6","#E0ADB7","#D8ACB8","#D0ABBA","#C8AABB","#C0A8BC","#B8A7BD","#B1A6BE","#A9A4C0","#A6A5BB","#AEA8AA","#B6AC9A","#BEAF89","#C6B378","#CEB667","#D5B957","#DDBD46","#E5C035","#EDC425","#F5C714","#FDCB03","#FFC808","#FFC513","#FFC11E","#FFBD29","#FFB934","#FFB540","#FFB14B","#FFAD56","#FFA961","#FFA56C","#FFA277","#FEA080","#F9A982","#F5B184","#F0B986","#ECC289","#E7CA8B","#E3D28D","#DFDB8F","#DAE391","#D6EB93","#D1F396","#CDFC98","#CDF99B","#CEF19E","#D0E8A1","#D2E0A5","#D3D8A8","#D5CFAB","#D6C7AE","#D8BFB2","#DAB6B5","#DBAEB8","#DDA6BC","#DF9FBE","#E2A3BB","#E4A7B8","#E7ABB4","#EAAFB1","#EDB2AE","#EFB6AA","#F2BAA7","#F5BEA4","#F8C2A1","#FBC69D","#FDCA9A","#FCCC9B","#F8CCA0","#F3CCA4","#EFCCA9","#EBCCAD","#E6CCB2","#E2CCB6","#DECCBB","#D9CCBF","#D5CCC4","#D1CCC8","#CDCDCD"],"color.background":["#CCDDFF","#C4DCF7","#BDDBEF","#B6DAE7","#AFD9E0","#A8D8D8","#A0D7D0","#99D6C9","#92D5C1","#8BD4B9","#84D3B1","#7CD2AA","#7ED0A6","#89CEA7","#95CBA8","#A0C8A9","#ACC6AB","#B8C3AC","#C3C0AD","#CFBEAE","#DABBAF","#E6B8B0","#F2B5B1","#FDB3B2","#F7B1B4","#F0B0B5","#E8AFB6","#E0ADB7","#D8ACB8","#D0ABBA","#C8AABB","#C0A8BC","#B8A7BD","#B1A6BE","#A9A4C0","#A6A5BB","#AEA8AA","#B6AC9A","#BEAF89","#C6B378","#CEB667","#D5B957","#DDBD46","#E5C035","#EDC425","#F5C714","#FDCB03","#FFC808","#FFC513","#FFC11E","#FFBD29","#FFB934","#FFB540","#FFB14B","#FFAD56","#FFA961","#FFA56C","#FFA277","#FEA080","#F9A982","#F5B184","#F0B986","#ECC289","#E7CA8B","#E3D28D","#DFDB8F","#DAE391","#D6EB93","#D1F396","#CDFC98","#CDF99B","#CEF19E","#D0E8A1","#D2E0A5","#D3D8A8","#D5CFAB","#D6C7AE","#D8BFB2","#DAB6B5","#DBAEB8","#DDA6BC","#DF9FBE","#E2A3BB","#E4A7B8","#E7ABB4","#EAAFB1","#EDB2AE","#EFB6AA","#F2BAA7","#F5BEA4","#F8C2A1","#FBC69D","#FDCA9A","#FCCC9B","#F8CCA0","#F3CCA4","#EFCCA9","#EBCCAD","#E6CCB2","#E2CCB6","#DECCBB","#D9CCBF","#D5CCC4","#D1CCC8","#CDCDCD"],"color.highlight.border":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"],"color.border":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"],"size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"borderWidth":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]},"edges":{"from":[1,1,5,4,6,12,9,15,2,22,22,25,25,29,16,31,34,25,36,30,38,41,28,44,41,23,45,45,37,31,42,54,47,61,54,46,79,68,80,60,74,71,70,88,83,64,63,34,113,69,90,108,113,80,73,107,70,78,64,105,55,108,113,103,128,156,99,128,89,92,106,103],"to":[2,5,8,10,11,16,19,21,23,25,30,32,33,34,36,38,42,43,46,51,52,53,55,57,59,61,65,66,69,70,78,79,80,81,83,86,90,92,96,98,100,102,107,111,114,115,117,119,120,121,122,125,127,129,133,136,138,141,142,144,149,152,153,154,158,159,160,161,162,164,165,166],"primary_onset_date":["2023-10-01","2023-10-01","2023-10-11","2023-10-10","2023-10-12","2023-10-18","2023-10-15","2023-10-20","2023-10-03","2023-10-25","2023-10-25","2023-10-28","2023-10-28","2023-10-30","2023-10-21","2023-10-31","2023-11-03","2023-10-28","2023-11-04","2023-10-30","2023-11-05","2023-11-06","2023-10-30","2023-11-06","2023-11-06","2023-10-26","2023-11-07","2023-11-07","2023-11-04","2023-10-31","2023-11-06","2023-11-10","2023-11-07","2023-11-12","2023-11-10","2023-11-07","2023-11-16","2023-11-14","2023-11-16","2023-11-12","2023-11-15","2023-11-14","2023-11-14","2023-11-18","2023-11-17","2023-11-13","2023-11-12","2023-11-03","2023-11-23","2023-11-14","2023-11-18","2023-11-22","2023-11-23","2023-11-16","2023-11-15","2023-11-21","2023-11-14","2023-11-16","2023-11-13","2023-11-21","2023-11-10","2023-11-22","2023-11-23","2023-11-21","2023-11-26","2023-11-29","2023-11-20","2023-11-26","2023-11-18","2023-11-18","2023-11-21","2023-11-21"],"secondary_onset_date":["2023-10-03","2023-10-11","2023-10-13","2023-10-16","2023-10-16","2023-10-21","2023-10-24","2023-10-24","2023-10-26","2023-10-28","2023-10-30","2023-11-03","2023-11-03","2023-11-03","2023-11-04","2023-11-05","2023-11-06","2023-11-06","2023-11-07","2023-11-08","2023-11-09","2023-11-10","2023-11-10","2023-11-11","2023-11-12","2023-11-12","2023-11-13","2023-11-13","2023-11-14","2023-11-14","2023-11-16","2023-11-16","2023-11-16","2023-11-16","2023-11-17","2023-11-17","2023-11-18","2023-11-18","2023-11-20","2023-11-20","2023-11-20","2023-11-20","2023-11-21","2023-11-22","2023-11-23","2023-11-23","2023-11-24","2023-11-25","2023-11-25","2023-11-25","2023-11-25","2023-11-26","2023-11-26","2023-11-26","2023-11-26","2023-11-27","2023-11-27","2023-11-27","2023-11-27","2023-11-28","2023-11-29","2023-11-29","2023-11-29","2023-11-29","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30","2023-11-30"],"width":[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"color":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"],"arrows.to":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"interaction":{"zoomSpeed":1},"edges":{"arrows":{"to":{"scaleFactor":2}}},"physics":{"stabilization":false}},"groups":null,"width":"90%","height":"700px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"id","main":"Select by id","values":[1,2,4,5,6,8,9,10,11,12,15,16,19,21,22,23,25,28,29,30,31,32,33,34,36,37,38,41,42,43,44,45,46,47,51,52,53,54,55,57,59,60,61,63,64,65,66,68,69,70,71,73,74,78,79,80,81,83,86,88,89,90,92,96,98,99,100,102,103,105,106,107,108,111,113,114,115,117,119,120,121,122,125,127,128,129,133,136,138,141,142,144,149,152,153,154,156,158,159,160,161,162,164,165,166]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #EEEEEE;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #000000;","legend":{"width":0.1,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":false},"opts_manipulation":{"datacss":"table.legend_table {\n  font-size: 11px;\n  border-width:1px;\n  border-color:#d3d3d3;\n  border-style:solid;\n}\ntable.legend_table td {\n  border-width:1px;\n  border-color:#d3d3d3;\n  border-style:solid;\n  padding: 2px;\n}\ndiv.table_content {\n  width:80px;\n  text-align:center;\n}\ndiv.table_description {\n  width:100px;\n}\n\n.operation {\n  font-size:20px;\n}\n\n.network-popUp {\n  display:none;\n  z-index:299;\n  width:250px;\n  /*height:150px;*/\n  background-color: #f9f9f9;\n  border-style:solid;\n  border-width:1px;\n  border-color: #0d0d0d;\n  padding:10px;\n  text-align: center;\n  position:fixed;\n  top:50%;  \n  left:50%;  \n  margin:-100px 0 0 -100px;  \n\n}","addNodeCols":["id","label"],"editNodeCols":["id","label"],"tab_add_node":"<span id=\"addnode-operation\" class = \"operation\">node<\/span> <br><table style=\"margin:auto;\"><tr><td>id<\/td><td><input id=\"addnode-id\"  type= \"text\" value=\"new value\"><\/td><\/tr><tr><td>label<\/td><td><input id=\"addnode-label\"  type= \"text\" value=\"new value\"><\/td><\/tr><\/table><input type=\"button\" value=\"save\" id=\"addnode-saveButton\"><\/button><input type=\"button\" value=\"cancel\" id=\"addnode-cancelButton\"><\/button>","tab_edit_node":"<span id=\"editnode-operation\" class = \"operation\">node<\/span> <br><table style=\"margin:auto;\"><tr><td>id<\/td><td><input id=\"editnode-id\"  type= \"text\" value=\"new value\"><\/td><\/tr><tr><td>label<\/td><td><input id=\"editnode-label\"  type= \"text\" value=\"new value\"><\/td><\/tr><\/table><input type=\"button\" value=\"save\" id=\"editnode-saveButton\"><\/button><input type=\"button\" value=\"cancel\" id=\"editnode-cancelButton\"><\/button>"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,1)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"iconsRedraw":true},"evals":[],"jsHooks":[]}</script><!--/html_preserve--><div class="alert alert-secondary">
<p><em>💡 <strong>Preguntas (2)</strong></em></p>
<ul>
<li>Describa los grupos (clusters).<br>
</li>
<li>¿Ve algún evento potencial de superpropagación (donde un caso
propaga el patógeno a muchos otros casos)?</li>
</ul>
</div>
</div>
</section><div class="section level1">
<h1 id="pausa-1-_________">
<em><code>_______Pausa 1 _________</code></em><a class="anchor" aria-label="anchor" href="#pausa-1-_________"></a>
</h1>
<hr>
<div class="section level2">
<h2 id="estimación-del-período-de-incubación">7. Estimación del período de incubación<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-del-per%C3%ADodo-de-incubaci%C3%B3n"></a>
</h2>
<p>Ahora, enfoquese en el período de incubación. Se utilizará los datos
del <code>linelist</code> para esta parte. Se necesitan ambos el tiempo
de inicio de sintomas y el timpo de la posible exposición. Note que en
los datos hay dos fechas de exposición, una de inicio y una de final.
Algunas veces la fecha exacta de exposición es desconocida y en su lugar
se obtiene la ventana de exposición durante la entrevista.</p>
<div class="alert alert-secondary">
<p><em>💡 <strong>Preguntas (3)</strong></em></p>
<ul>
<li><p>¿Para cuántos casos tiene datos tanto de la fecha de inicio de
síntomas como de exposición?</p></li>
<li><p>Calcule las ventanas de exposición. ¿Cuántos casos tienen una
única fecha de exposición?</p></li>
</ul>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ip</span> <span class="op">&lt;-</span> <span class="fu">filter</span><span class="op">(</span><span class="va">linelist</span>, <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">exposure_start</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>               <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">exposure_end</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">nrow</span><span class="op">(</span><span class="va">ip</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 50</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_window</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_end</span> <span class="op">-</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">table</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_window</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
 0  1  2 
34 11  5 </code></pre>
</div>
<div class="section level3">
<h3 id="estimación-naive-del-período-de-incubación">7.1. Estimación naive del período de incubación<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-naive-del-per%C3%ADodo-de-incubaci%C3%B3n"></a>
</h3>
<p>Empiece calculando una estimación naive del período de
incubación.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Máximo tiempo de período de incubación</span></span>
<span><span class="va">ip</span><span class="op">$</span><span class="va">max_ip</span> <span class="op">&lt;-</span> <span class="va">ip</span><span class="op">$</span><span class="va">date_onset</span> <span class="op">-</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">max_ip</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00    3.00    4.50    6.38    7.75   20.00 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mínimo tiempo de período de incubación</span></span>
<span><span class="va">ip</span><span class="op">$</span><span class="va">min_ip</span> <span class="op">&lt;-</span> <span class="va">ip</span><span class="op">$</span><span class="va">date_onset</span> <span class="op">-</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_end</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">min_ip</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00    2.00    4.00    5.96    7.75   19.00 </code></pre>
</div>
</div>
<div class="section level3">
<h3 id="censura-estimada-ajustada-del-período-de-incubación">7.2. Censura estimada ajustada del período de incubación<a class="anchor" aria-label="anchor" href="#censura-estimada-ajustada-del-per%C3%ADodo-de-incubaci%C3%B3n"></a>
</h3>
<p>Ahora, ajuste tres distribuciones de probabilidad a los datos del
período de incubación teniendo en cuenta la censura doble. Adapte un
código de <code>stan</code> que fue publicado por Miura et al. durante
el brote global de mpox de 2022. Este método no tiene en cuenta el
truncamiento a la derecha ni el sesgo dinámico.</p>
<p>Recuerde que el interés principal es considerar tres distribuciones
de probabilidad: <em>Weibull</em>, <em>gamma</em> y <em>log normal</em>
(Ver Tabla 1).</p>
<p><code>Stan</code> es un programa de software que implementa el
algoritmo Monte Carlo Hamiltoniano (HMC por su siglas en inglés de
Hamiltonian Monte Carlo). HMC es un método de Monte Carlo de cadena de
Markov (MCMC) para ajustar modelos complejos a datos utilizando
estadísticas bayesianas.</p>
<div class="section level4">
<h4 id="corra-el-modelo-en-stan">
<strong>7.1.1. Corra el modelo en Stan</strong><a class="anchor" aria-label="anchor" href="#corra-el-modelo-en-stan"></a>
</h4>
<p>Ajuste las tres distribuciones en este bloque de código.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare los datos</span></span>
<span><span class="va">earliest_exposure</span> <span class="op">&lt;-</span> <span class="fu">as.Date</span><span class="op">(</span><span class="fu">min</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ip</span> <span class="op">&lt;-</span> <span class="va">ip</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>date_onset <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">date_onset</span> <span class="op">-</span> <span class="va">earliest_exposure</span><span class="op">)</span>,</span>
<span>         exposure_start <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">exposure_start</span> <span class="op">-</span> <span class="va">earliest_exposure</span><span class="op">)</span>,</span>
<span>         exposure_end <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">exposure_end</span> <span class="op">-</span> <span class="va">earliest_exposure</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">date_onset</span>, <span class="va">exposure_start</span>, <span class="va">exposure_end</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Configure algunas opciones para ejecutar las cadenas MCMC en paralelo</span></span>
<span><span class="co"># Ejecución de las cadenas MCMC en paralelo significa que se ejecutaran varias cadenas al mismo tiempo usando varios núcleos de su computador</span></span>
<span><span class="fu">options</span><span class="op">(</span>mc.cores<span class="op">=</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu">detectCores</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">input_data</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>N <span class="op">=</span> <span class="fu">length</span><span class="op">(</span><span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span><span class="op">)</span>, <span class="co"># NNúmero de observaciones</span></span>
<span>              tStartExposure <span class="op">=</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_start</span>,</span>
<span>              tEndExposure <span class="op">=</span> <span class="va">ip</span><span class="op">$</span><span class="va">exposure_end</span>,</span>
<span>              tSymptomOnset <span class="op">=</span> <span class="va">ip</span><span class="op">$</span><span class="va">date_onset</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tres distribuciones de probabilidad</span></span>
<span><span class="va">distributions</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"weibull"</span>, <span class="st">"gamma"</span>, <span class="st">"lognormal"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Código de Stan </span></span>
<span><span class="va">code</span> <span class="op">&lt;-</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  data{</span></span>
<span><span class="st">    int&lt;lower=1&gt; N;</span></span>
<span><span class="st">    vector[N] tStartExposure;</span></span>
<span><span class="st">    vector[N] tEndExposure;</span></span>
<span><span class="st">    vector[N] tSymptomOnset;</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">  parameters{</span></span>
<span><span class="st">    real&lt;lower=0&gt; par[2];</span></span>
<span><span class="st">    vector&lt;lower=0, upper=1&gt;[N] uE;  // Uniform value for sampling between start and end exposure</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">  transformed parameters{</span></span>
<span><span class="st">    vector[N] tE;   // infection moment</span></span>
<span><span class="st">    tE = tStartExposure + uE .* (tEndExposure - tStartExposure);</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">model{</span></span>
<span><span class="st">    // Contribution to likelihood of incubation period</span></span>
<span><span class="st">    target += %s_lpdf(tSymptomOnset -  tE  | par[1], par[2]);</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">  generated quantities {</span></span>
<span><span class="st">    // likelihood for calculation of looIC</span></span>
<span><span class="st">    vector[N] log_lik;</span></span>
<span><span class="st">    for (i in 1:N) {</span></span>
<span><span class="st">      log_lik[i] = %s_lpdf(tSymptomOnset[i] -  tE[i]  | par[1], par[2]);</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">"</span>, <span class="va">distributions</span>, <span class="va">distributions</span><span class="op">)</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">code</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">distributions</span></span>
<span></span>
<span><span class="co"># La siguiente línea puede tomar ~1.5 min</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu">mapply</span><span class="op">(</span><span class="va">stan_model</span>, model_code <span class="op">=</span> <span class="va">code</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Toma ~40 sec.</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">mapply</span><span class="op">(</span><span class="va">sampling</span>, <span class="va">models</span>, <span class="fu">list</span><span class="op">(</span><span class="va">input_data</span><span class="op">)</span>, </span>
<span>              iter<span class="op">=</span><span class="fl">3000</span>, <span class="co"># Número de iteraciones (largo de la cadena MCMC)</span></span>
<span>              warmup<span class="op">=</span><span class="fl">1000</span>, <span class="co"># Número de muestras a descartar al inicio de MCMC</span></span>
<span>              chain<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="co"># Número de cadenas MCMC a ejecutar</span></span>
<span></span>
<span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu">mapply</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu">rstan</span><span class="fu">::</span><span class="fu">extract</span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">$</span><span class="va">par</span>, <span class="va">fit</span>, SIMPLIFY<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># muestreo posterior </span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="revisar-si-hay-convergencia">
<strong>7.1.2. Revisar si hay convergencia</strong><a class="anchor" aria-label="anchor" href="#revisar-si-hay-convergencia"></a>
</h4>
<p>Ahora verifique la convergencia del modelo. Observe los valores de
r-hat, los tamaños de muestra efectivos y las trazas MCMC. R-hat compara
las estimaciones entre y dentro de cadenas para los parámetros del
modelo; valores cercanos a 1 indican que las cadenas se han mezclado
bien (Vehtari et al. 2021). El tamaño de muestra efectivo estima el
número de muestras independientes después de tener en cuenta la
dependencia en las cadenas MCMC (Lambert 2018). Para un modelo con 4
cadenas MCMC, se recomienda un tamaño total de muestra efectiva de al
menos 400 (Vehtari et al. 2021).</p>
<p>Para cada modelo con distribución ajustada:</p>
<div class="alert alert-secondary">
<p><em>💡 <strong>Questions (4)</strong></em></p>
<ul>
<li><p>¿Los valores de r-hat son cercanos a 1?</p></li>
<li><p>¿Las 4 cadenas MCMC generalmente se superponen y permanecen
alrededor de los mismos valores (se ven como orugas peludas)?</p></li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="convergencia-para-gamma">
<strong>7.1.2.1. Convergencia para Gamma</strong><a class="anchor" aria-label="anchor" href="#convergencia-para-gamma"></a>
</h4>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">gamma</span>, digits <span class="op">=</span> <span class="fl">3</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Inference for Stan model: anon_model.
4 chains, each with iter=3000; warmup=1000; thin=1; 
post-warmup draws per chain=2000, total post-warmup draws=8000.

        mean se_mean    sd  2.5%   25%   50%   75% 97.5% n_eff Rhat
par[1] 1.983   0.003 0.361 1.342 1.728 1.959 2.211 2.756 11718    1
par[2] 0.324   0.001 0.067 0.206 0.277 0.320 0.367 0.468 11541    1

Samples were drawn using NUTS(diag_e) at Sun Dec  3 22:39:33 2023.
For each parameter, n_eff is a crude measure of effective sample size,
and Rhat is the potential scale reduction factor on split chains (at 
convergence, Rhat=1).</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rstan</span><span class="fu">::</span><span class="fu">traceplot</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">gamma</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/EnfermedadX-rendered-convergence%20gamma-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level4">
<h4 id="convergencia-para-log-normal">
<strong>7.1.2.2. Convergencia para log normal</strong><a class="anchor" aria-label="anchor" href="#convergencia-para-log-normal"></a>
</h4>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">lognormal</span>, digits <span class="op">=</span> <span class="fl">3</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Inference for Stan model: anon_model.
4 chains, each with iter=3000; warmup=1000; thin=1; 
post-warmup draws per chain=2000, total post-warmup draws=8000.

        mean se_mean    sd  2.5%   25%   50%   75% 97.5% n_eff Rhat
par[1] 1.529   0.001 0.114 1.305 1.453 1.530 1.606 1.752 10877    1
par[2] 0.801   0.001 0.085 0.657 0.741 0.794 0.854 0.985  9184    1

Samples were drawn using NUTS(diag_e) at Sun Dec  3 22:39:40 2023.
For each parameter, n_eff is a crude measure of effective sample size,
and Rhat is the potential scale reduction factor on split chains (at 
convergence, Rhat=1).</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rstan</span><span class="fu">::</span><span class="fu">traceplot</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">lognormal</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/EnfermedadX-rendered-convergence%20lognormal-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level4">
<h4 id="convergencia-para-weibull">
<strong>7.1.2.3. Convergencia para Weibull</strong><a class="anchor" aria-label="anchor" href="#convergencia-para-weibull"></a>
</h4>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">weibull</span>, digits <span class="op">=</span> <span class="fl">3</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Inference for Stan model: anon_model.
4 chains, each with iter=3000; warmup=1000; thin=1; 
post-warmup draws per chain=2000, total post-warmup draws=8000.

        mean se_mean    sd  2.5%   25%   50%   75% 97.5% n_eff Rhat
par[1] 1.372   0.002 0.149 1.093 1.268 1.370 1.470 1.671  8979    1
par[2] 6.974   0.008 0.778 5.564 6.439 6.937 7.474 8.611  8578    1

Samples were drawn using NUTS(diag_e) at Sun Dec  3 22:39:26 2023.
For each parameter, n_eff is a crude measure of effective sample size,
and Rhat is the potential scale reduction factor on split chains (at 
convergence, Rhat=1).</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rstan</span><span class="fu">::</span><span class="fu">traceplot</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">weibull</span>, pars <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"par[1]"</span>,<span class="st">"par[2]"</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/EnfermedadX-rendered-convergence%20weibull-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level4">
<h4 id="calcule-los-criterios-de-comparación-de-los-modelos">
<strong>7.1.3. Calcule los criterios de comparación de los
modelos</strong><a class="anchor" aria-label="anchor" href="#calcule-los-criterios-de-comparaci%C3%B3n-de-los-modelos"></a>
</h4>
<p>Calcule el criterio de información ampliamente aplicable (WAIC) y el
criterio de información de dejar-uno-fuera (LOOIC) para comparar los
ajustes de los modelos. El modelo con mejor ajuste es aquel con el WAIC
o LOOIC más bajo. En esta sección también se resumirá las distribuciones
y se hará algunos gráficos.</p>
<div class="alert alert-secondary">
<p><em>💡 <strong>Questions (5)</strong></em></p>
<ul>
<li>¿Qué modelo tiene mejor ajuste?</li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="section"></h4>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calcule WAIC para los tres modelos</span></span>
<span><span class="va">waic</span> <span class="op">&lt;-</span> <span class="fu">mapply</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu">waic</span><span class="op">(</span><span class="fu">extract_log_lik</span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span>, <span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">waic</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          weibull     gamma lognormal
Estimate 278.1658 276.22399 272.82976
SE        11.9069  13.39728  13.87513</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Para looic, se necesita proveer los tamaños de muestra relativos</span></span>
<span><span class="co"># al llamar a loo. Este paso lleva a mejores estimados de los tamaños de </span></span>
<span><span class="co"># muestra PSIS efectivos y del error de Monte Carlo </span></span>
<span></span>
<span><span class="co"># Extraer la verosimilitud puntual logarítmica para la distribución Weibull</span></span>
<span><span class="va">loglik</span> <span class="op">&lt;-</span> <span class="fu">extract_log_lik</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">weibull</span>, merge_chains <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Obtener los tamaños de muestra relativos efectivos</span></span>
<span><span class="va">r_eff</span> <span class="op">&lt;-</span> <span class="fu">relative_eff</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">loglik</span><span class="op">)</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># Calcula LOOIC</span></span>
<span><span class="va">loo_w</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="op">(</span><span class="va">loglik</span>, r_eff <span class="op">=</span> <span class="va">r_eff</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span></span>
<span><span class="co"># Imprimir los resultados</span></span>
<span><span class="va">loo_w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">Estimate</span> </span>
<span><span class="fl">278.1958</span> </span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extraer la verosimilitud puntual logarítmica para la distribución gamma </span></span>
<span><span class="va">loglik</span> <span class="op">&lt;-</span> <span class="fu">extract_log_lik</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">gamma</span>, merge_chains <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">r_eff</span> <span class="op">&lt;-</span> <span class="fu">relative_eff</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">loglik</span><span class="op">)</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">loo_g</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="op">(</span><span class="va">loglik</span>, r_eff <span class="op">=</span> <span class="va">r_eff</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span></span>
<span><span class="va">loo_g</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">Estimate</span> </span>
<span><span class="fl">276.2397</span> </span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extraer la verosimilitud puntual logarítmica para la distribución log normal </span></span>
<span><span class="va">loglik</span> <span class="op">&lt;-</span> <span class="fu">extract_log_lik</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">lognormal</span>, merge_chains <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">r_eff</span> <span class="op">&lt;-</span> <span class="fu">relative_eff</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">loglik</span><span class="op">)</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">loo_l</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="op">(</span><span class="va">loglik</span>, r_eff <span class="op">=</span> <span class="va">r_eff</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span></span>
<span><span class="va">loo_l</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">Estimate</span> </span>
<span><span class="fl">272.8405</span> </span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="reporte-los-resultados">
<strong>7.1.4. Reporte los resultados</strong><a class="anchor" aria-label="anchor" href="#reporte-los-resultados"></a>
</h4>
<p>La cola derecha de la distribución del período de incubación es
importante para diseñar estrategias de control (por ejemplo,
cuarentena), los percentiles del 25 al 75 informan sobre el momento más
probable en que podría ocurrir la aparición de síntomas, y la
distribución completa puede usarse como una entrada en modelos
matemáticos o estadísticos, como para pronósticos (Lessler et
al. 2009).</p>
<p>Obtenga las estadísticas resumidas.</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We need to convert the parameters of the distributions to the mean and standard deviation delay</span></span>
<span></span>
<span><span class="co"># In Stan, the parameters of the distributions are:</span></span>
<span><span class="co"># Weibull: shape and scale</span></span>
<span><span class="co"># Gamma: shape and inverse scale (aka rate)</span></span>
<span><span class="co"># Log normal: mu and sigma</span></span>
<span><span class="co"># Reference: https://mc-stan.org/docs/2_21/functions-reference/positive-continuous-distributions.html</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="co"># mean of Weibull</span></span>
<span>               <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="co"># mean of gamma</span></span>
<span>               <span class="fu">exp</span><span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># mean of log normal</span></span>
<span></span>
<span><span class="va">standard_deviations</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span><span class="fu">sqrt</span><span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">2</span><span class="op">/</span><span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             <span class="fu">sqrt</span><span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             <span class="fu">sqrt</span><span class="op">(</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the mean delays and 95% credible intervals</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_means</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">means</span>, <span class="fl">2</span>, <span class="va">quantile</span>, <span class="va">probs</span><span class="op">)</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">res_means</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">colnames</span><span class="op">(</span><span class="va">waic</span><span class="op">)</span></span>
<span><span class="va">res_means</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       weibull    gamma lognormal
2.5%  5.176877 5.030843  5.016599
50%   6.357164 6.128345  6.339173
97.5% 7.905445 7.561368  8.450425</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_sds</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">standard_deviations</span>, <span class="fl">2</span>, <span class="va">quantile</span>, <span class="va">probs</span><span class="op">)</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">res_sds</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">colnames</span><span class="op">(</span><span class="va">waic</span><span class="op">)</span></span>
<span><span class="va">res_sds</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       weibull    gamma lognormal
2.5%  3.703054 3.417395  3.982472
50%   4.674519 4.368469  5.913868
97.5% 6.449455 5.873452 10.123743</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Report the median and 95% credible intervals for the quantiles of each distribution</span></span>
<span><span class="va">quantiles_to_report</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>, <span class="fl">0.99</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Weibull</span></span>
<span><span class="va">cens_w_percentiles</span> <span class="op">&lt;-</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">quantiles_to_report</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">qweibull</span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="va">probs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">cens_w_percentiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">quantiles_to_report</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">cens_w_percentiles</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          0.025      0.05      0.5     0.95    0.975     0.99
2.5%  0.2187522 0.4154240 4.102373 12.57757 14.48539 16.77056
50%   0.4738430 0.7919183 5.308907 15.43557 17.97290 21.12660
97.5% 0.8406648 1.2886249 6.655287 20.29349 24.21347 29.33028</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Gamma</span></span>
<span><span class="va">cens_g_percentiles</span> <span class="op">&lt;-</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">quantiles_to_report</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">qgamma</span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, rate <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="va">probs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">cens_g_percentiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">quantiles_to_report</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">cens_g_percentiles</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          0.025      0.05      0.5     0.95    0.975     0.99
2.5%  0.3342093 0.5664656 4.106965 11.83008 13.78960 16.26057
50%   0.7196451 1.0626606 5.122019 14.61505 17.18492 20.49634
97.5% 1.1900510 1.6208902 6.309097 18.90259 22.53968 27.26054</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Log normal</span></span>
<span><span class="va">cens_ln_percentiles</span> <span class="op">&lt;-</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">quantiles_to_report</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">qlnorm</span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, meanlog <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, sdlog<span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="va">probs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">cens_ln_percentiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">quantiles_to_report</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">cens_ln_percentiles</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          0.025      0.05      0.5     0.95    0.975     0.99
2.5%  0.6274741 0.8459504 3.688554 12.56880 15.60993 20.02950
50%   0.9751362 1.2521179 4.619095 17.01012 21.83923 29.18417
97.5% 1.3628378 1.6934989 5.765587 25.16803 33.98634 48.53571</code></pre>
</div>
<p>Para cada modelo, encuentre estos elementos para el período de
incubación estimado en la salida de arriba y escribalos abajo.</p>
<ul>
<li><p>Media e intervalo de credibilidad del 95%</p></li>
<li><p>Desviación estándar e intervalo de credibilidad del 95%</p></li>
<li><p>Percentiles (e.g., 2.5, 5, 25, 50, 75, 95, 97.5, 99)</p></li>
<li><p>Los parámetros de las distribuciones ajustadas (e.g., shape y
scale para distribución gamma)</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="grafique-los-resultados">
<strong>7.1.5. Grafique los resultados</strong><a class="anchor" aria-label="anchor" href="#grafique-los-resultados"></a>
</h4>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare los resultados para graficarlos</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span><span class="co">#Tome los valores de las medias para trazar la función de densidad acumulatica empirica</span></span>
<span>  inc_day <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">input_data</span><span class="op">$</span><span class="va">tSymptomOnset</span><span class="op">-</span><span class="va">input_data</span><span class="op">$</span><span class="va">tEndExposure</span><span class="op">)</span><span class="op">+</span><span class="op">(</span><span class="va">input_data</span><span class="op">$</span><span class="va">tSymptomOnset</span><span class="op">-</span><span class="va">input_data</span><span class="op">$</span><span class="va">tStartExposure</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_plot</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span>, by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="co"># Esto configura el rango del eje x (número de días)</span></span>
<span></span>
<span><span class="va">Gam_plot</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>dose<span class="op">=</span> <span class="va">x_plot</span>, </span>
<span>                               pred<span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pgamma</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, rate <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               low <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pgamma</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, rate <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               upp <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pgamma</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, rate <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Wei_plot</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>dose<span class="op">=</span> <span class="va">x_plot</span>, </span>
<span>                               pred<span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pweibull</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               low <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pweibull</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               upp <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">pweibull</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, shape <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">weibull</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ln_plot</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>dose<span class="op">=</span> <span class="va">x_plot</span>, </span>
<span>                              pred<span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">plnorm</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, meanlog <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, sdlog<span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              low <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">plnorm</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, meanlog <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, sdlog<span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              upp <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">x_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="fu">quantile</span><span class="op">(</span><span class="fu">plnorm</span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>, meanlog <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, sdlog<span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">lognormal</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Grafique las curvas de la distribución acumulada </span></span>
<span><span class="va">gamma_ggplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">inc_day</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_ecdf</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">Gam_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>, y<span class="op">=</span><span class="va">pred</span><span class="op">)</span>, color<span class="op">=</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span>data<span class="op">=</span><span class="va">Gam_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>,ymin<span class="op">=</span><span class="va">low</span>,ymax<span class="op">=</span><span class="va">upp</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Incubation period (days)"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Gamma"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">weibul_ggplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">inc_day</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_ecdf</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">Wei_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>, y<span class="op">=</span><span class="va">pred</span><span class="op">)</span>, color<span class="op">=</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span>data<span class="op">=</span><span class="va">Wei_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>,ymin<span class="op">=</span><span class="va">low</span>,ymax<span class="op">=</span><span class="va">upp</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Incubation period (days)"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Weibull"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lognorm_ggplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">inc_day</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_ecdf</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">ln_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>, y<span class="op">=</span><span class="va">pred</span><span class="op">)</span>, color<span class="op">=</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span>data<span class="op">=</span><span class="va">ln_plot</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x_plot</span>,ymin<span class="op">=</span><span class="va">low</span>,ymax<span class="op">=</span><span class="va">upp</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">brewer.pal</span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Incubation period (days)"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Log normal"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">lognorm_ggplot</span><span class="op">|</span><span class="va">gamma_ggplot</span><span class="op">|</span><span class="va">weibul_ggplot</span><span class="op">)</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/EnfermedadX-rendered-plot%20ip-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>En los gráficos anteriores, la línea negra es la distribución
acumulativa empírica (los datos), mientras que la curva azul es la
distribución de probabilidad ajustada con los intervalos de credibilidad
del 95%. Asegúrese de que la curva azul esté sobre la línea negra.</p>
<div class="alert alert-secondary">
<p><em>💡 <strong>Preguntas (6)</strong></em></p>
<ul>
<li>¿Son los ajustes de las distribuciones lo que espera?</li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="section-1"></h4>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="pausa-2-_________">
<em><code>_______Pausa 2 _________</code></em><a class="anchor" aria-label="anchor" href="#pausa-2-_________"></a>
</h1>
<div class="section level2">
<h2 id="estimación-del-intervalo-serial">8. Estimación del intervalo serial<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-del-intervalo-serial"></a>
</h2>
<p>Ahora, estime el intervalo serial. Nuevamente, se realizará primero
una estimación navie calculando la diferencia entre la fecha de inicio
de síntomas entre el par de casos primario y secundario.</p>
<ol style="list-style-type: decimal">
<li><p>¿Existen casos con intervalos seriales negativos en los datos
(por ejemplo, el inicio de los síntomas en el caso secundario ocurrió
antes del inicio de los síntomas en el caso primario)?</p></li>
<li><p>Informe la mediana del intervalo serial, así como el mínimo y el
máximo.</p></li>
<li><p>Grafique la distribución del intervalo serial.</p></li>
</ol>
<div class="section level3">
<h3 id="estimación-naive">8.1. Estimación naive<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-naive"></a>
</h3>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">secondary_onset_date</span> <span class="op">-</span> <span class="va">contacts</span><span class="op">$</span><span class="va">primary_onset_date</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   4.000   6.000   7.625  10.000  23.000 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span>, xlab <span class="op">=</span> <span class="st">"Serial interval (days)"</span>, breaks <span class="op">=</span> <span class="fl">25</span>, main <span class="op">=</span> <span class="st">""</span>, col <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/EnfermedadX-rendered-si%20naive-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="estimación-ajustada-por-censura">8.2. Estimación ajustada por censura<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-ajustada-por-censura"></a>
</h3>
<p>Ahora se estimará el intervalo serial utilizando una implementación
del paquete <code>courseDataTools</code> dentro del paquete R
<code>EpiEstim</code>. Este método tiene en cuenta la censura doble y
permite comparar diferentes distribuciones de probabilidad, pero no se
ajusta por truncamiento a la derecha o sesgo dinámico.</p>
<p>Se considerará tres distribuciones de probabilidad y deberá
seleccionar la que mejor se ajuste a los datos utilizando WAIC o LOOIC.
Recuerde que la distribución con mejor ajuste tendrá el WAIC o LOOIC más
bajo.</p>
<p>Ten en cuenta que en <code>coarseDataTools</code>, los parámetros
para las distribuciones son ligeramente diferentes que en rstan. Aquí,
los parámetros para la distribución gamma son shape y scale (forma y
escala) (<a href="https://cran.r-project.org/web/packages/coarseDataTools/coarseDataTools.pdf" class="external-link uri">https://cran.r-project.org/web/packages/coarseDataTools/coarseDataTools.pdf</a>).</p>
<p>Solo se ejecutará una cadena MCMC para cada distribución en interés
del tiempo, pero en la práctica debería ejecutar más de una cadena para
asegurarse de que el MCMC converge en la distribución objetivo. Usará
las distribuciones a priori predeterminadas, que se pueden encontrar en
la documentación del paquete (ver ‘detalles’ para la función
dic.fit.mcmc aquí: (<a href="https://cran.r-project.org/web/packages/coarseDataTools/coarseDataTools.pdf" class="external-link uri">https://cran.r-project.org/web/packages/coarseDataTools/coarseDataTools.pdf</a>).</p>
<div class="section level4">
<h4 id="preparación-de-los-datos">8.2.1. Preparación de los datos<a class="anchor" aria-label="anchor" href="#preparaci%C3%B3n-de-los-datos"></a>
</h4>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Format interval-censored serial interval data</span></span>
<span></span>
<span><span class="co"># Each line represents a transmission event </span></span>
<span><span class="co"># EL/ER show the lower/upper bound of the symptoms onset date in the primary case (infector)</span></span>
<span><span class="co"># SL/SR show the same for the secondary case (infectee)</span></span>
<span><span class="co"># type has entries 0 corresponding to doubly interval-censored data</span></span>
<span><span class="co"># (see Reich et al. Statist. Med. 2009)</span></span>
<span><span class="va">si_data</span> <span class="op">&lt;-</span> <span class="va">contacts</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">primary_case_id</span>, <span class="op">-</span><span class="va">secondary_case_id</span>, <span class="op">-</span><span class="va">primary_onset_date</span>, <span class="op">-</span><span class="va">secondary_onset_date</span>,<span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>SL <span class="op">=</span> <span class="va">diff</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>type <span class="op">=</span> <span class="fl">0</span>, EL <span class="op">=</span> <span class="fl">0</span>, ER <span class="op">=</span> <span class="fl">1</span>, SR <span class="op">=</span> <span class="va">SL</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">EL</span>, <span class="va">ER</span>, <span class="va">SL</span>, <span class="va">SR</span>, <span class="va">type</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="ajuste-una-distribución-gamma-para-el-si">8.2.2. Ajuste una distribución gamma para el SI<a class="anchor" aria-label="anchor" href="#ajuste-una-distribuci%C3%B3n-gamma-para-el-si"></a>
</h4>
<p>Primero, ajuste una distribución gamma al intervalo serial.</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">overall_seed</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># seed for the random number generator for MCMC</span></span>
<span><span class="va">MCMC_seed</span> <span class="op">&lt;-</span> <span class="fl">007</span></span>
<span></span>
<span><span class="co"># We will run the model for 4000 iterations with the first 1000 samples discarded as burnin</span></span>
<span><span class="va">n_mcmc_samples</span> <span class="op">&lt;-</span> <span class="fl">3000</span> <span class="co"># number of samples to draw from the posterior (after the burnin)</span></span>
<span></span>
<span><span class="va">params</span> <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>dist <span class="op">=</span> <span class="st">"G"</span>, <span class="co"># Fitting a Gamma distribution for the SI</span></span>
<span>method <span class="op">=</span> <span class="st">"MCMC"</span>, <span class="co"># MCMC using coarsedatatools</span></span>
<span>burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># number of burnin samples (samples discarded at the beginning of MCMC) </span></span>
<span>n1 <span class="op">=</span> <span class="fl">50</span>, <span class="co"># n1 is the number of pairs of mean and sd of the SI that are drawn</span></span>
<span>n2 <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="co"># n2 is the size of the posterior sample drawn for each pair of mean, sd of SI</span></span>
<span></span>
<span><span class="va">mcmc_control</span> <span class="op">&lt;-</span> <span class="fu">make_mcmc_control</span><span class="op">(</span></span>
<span>seed <span class="op">=</span> <span class="va">MCMC_seed</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">burnin</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">dist</span></span>
<span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">make_config</span><span class="op">(</span></span>
<span><span class="fu">list</span><span class="op">(</span></span>
<span>si_parametric_distr <span class="op">=</span> <span class="va">dist</span>,</span>
<span>mcmc_control <span class="op">=</span> <span class="va">mcmc_control</span>,</span>
<span>seed <span class="op">=</span> <span class="va">overall_seed</span>,</span>
<span>n1 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n1</span>,</span>
<span>n2 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fitting the SI</span></span>
<span><span class="va">si_fit_gamma</span> <span class="op">&lt;-</span> <span class="fu">coarseDataTools</span><span class="fu">::</span><span class="fu">dic.fit.mcmc</span><span class="op">(</span></span>
<span>dat <span class="op">=</span> <span class="va">si_data</span>,</span>
<span>dist <span class="op">=</span> <span class="va">dist</span>,</span>
<span>init.pars <span class="op">=</span> <span class="fu">init_mcmc_params</span><span class="op">(</span><span class="va">si_data</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">burnin</span>,</span>
<span>n.samples <span class="op">=</span> <span class="va">n_mcmc_samples</span>,</span>
<span>seed <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Running 4000 MCMC iterations 
MCMCmetrop1R iteration 1 of 4000 
function value = -201.95281
theta = 
   1.04012
   0.99131
Metropolis acceptance rate = 0.00000

MCMCmetrop1R iteration 1001 of 4000 
function value = -202.42902
theta = 
   0.95294
   1.05017
Metropolis acceptance rate = 0.55445

MCMCmetrop1R iteration 2001 of 4000 
function value = -201.88547
theta = 
   1.18355
   0.82124
Metropolis acceptance rate = 0.56522

MCMCmetrop1R iteration 3001 of 4000 
function value = -202.11109
theta = 
   1.26323
   0.77290
Metropolis acceptance rate = 0.55148



@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
The Metropolis acceptance rate was 0.55500
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</code></pre>
</div>
<p>Ahora observe los resultados.</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check convergence of MCMC chains </span></span>
<span><span class="va">converg_diag_gamma</span> <span class="op">&lt;-</span> <span class="fu">check_cdt_samples_convergence</span><span class="op">(</span><span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="va">converg_diag_gamma</span></span>
<span></span>
<span></span>
<span><span class="co"># Save MCMC samples in dataframe</span></span>
<span><span class="va">si_samples_gamma</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>type <span class="op">=</span> <span class="st">'Symptom onset'</span>,</span>
<span>shape <span class="op">=</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>,</span>
<span>scale <span class="op">=</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span>,</span>
<span>p50 <span class="op">=</span> <span class="fu">qgamma</span><span class="op">(</span></span>
<span>p <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>shape <span class="op">=</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>, </span>
<span>scale <span class="op">=</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu">mutate</span><span class="op">(</span> <span class="co"># Equation for conversion is here https://en.wikipedia.org/wiki/Gamma_distribution</span></span>
<span>mean <span class="op">=</span> <span class="va">shape</span><span class="op">*</span><span class="va">scale</span>,</span>
<span>sd <span class="op">=</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">shape</span><span class="op">*</span><span class="va">scale</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Get the mean, SD, and 95% CrI</span></span>
<span></span>
<span></span>
<span><span class="va">si_summary_gamma</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">si_samples_gamma</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>mean_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>mean_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>mean_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>sd_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>sd_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>sd_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">si_summary_gamma</span></span>
<span></span>
<span><span class="co"># Get the same summary statistics for the parameters of the distribution</span></span>
<span><span class="va">si_samples_gamma</span> <span class="op">|&gt;</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>shape_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>shape_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>shape_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>scale_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>scale_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>scale_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We will need these for plotting later</span></span>
<span><span class="va">gamma_shape</span> <span class="op">&lt;-</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'shape'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">gamma_rate</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">si_fit_gamma</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'scale'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="ajuste-de-una-distribución-log-normal-para-el-intervalo-serial">8.2.3. Ajuste de una distribución log normal para el intervalo
serial<a class="anchor" aria-label="anchor" href="#ajuste-de-una-distribuci%C3%B3n-log-normal-para-el-intervalo-serial"></a>
</h4>
<p>Ahora, ajuste una distribución log normal a los datos del intervalo
serial.</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We will run the model for 4000 iterations with the first 1000 samples discarded as burnin</span></span>
<span><span class="va">n_mcmc_samples</span> <span class="op">&lt;-</span> <span class="fl">3000</span> <span class="co"># number of samples to draw from the posterior (after the burnin)</span></span>
<span></span>
<span><span class="va">params</span> <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>dist <span class="op">=</span> <span class="st">"L"</span>, <span class="co"># Fitting a log normal distribution for the SI</span></span>
<span>method <span class="op">=</span> <span class="st">"MCMC"</span>, <span class="co"># MCMC using coarsedatatools</span></span>
<span>burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># number of burnin samples (samples discarded at the beginning of MCMC) </span></span>
<span>n1 <span class="op">=</span> <span class="fl">50</span>, <span class="co"># n1 is the number of pairs of mean and sd of the SI that are drawn</span></span>
<span>n2 <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="co"># n2 is the size of the posterior sample drawn for each pair of mean, sd of SI</span></span>
<span></span>
<span><span class="va">mcmc_control</span> <span class="op">&lt;-</span> <span class="fu">make_mcmc_control</span><span class="op">(</span></span>
<span>seed <span class="op">=</span> <span class="va">MCMC_seed</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">burnin</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">dist</span></span>
<span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">make_config</span><span class="op">(</span></span>
<span><span class="fu">list</span><span class="op">(</span></span>
<span>si_parametric_distr <span class="op">=</span> <span class="va">dist</span>,</span>
<span>mcmc_control <span class="op">=</span> <span class="va">mcmc_control</span>,</span>
<span>seed <span class="op">=</span> <span class="va">overall_seed</span>,</span>
<span>n1 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n1</span>,</span>
<span>n2 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fitting the serial interval</span></span>
<span><span class="va">si_fit_lnorm</span> <span class="op">&lt;-</span> <span class="fu">coarseDataTools</span><span class="fu">::</span><span class="fu">dic.fit.mcmc</span><span class="op">(</span></span>
<span>dat <span class="op">=</span> <span class="va">si_data</span>,</span>
<span>dist <span class="op">=</span> <span class="va">dist</span>,</span>
<span>init.pars <span class="op">=</span> <span class="fu">init_mcmc_params</span><span class="op">(</span><span class="va">si_data</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">burnin</span>,</span>
<span>n.samples <span class="op">=</span> <span class="va">n_mcmc_samples</span>,</span>
<span>seed <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Running 4000 MCMC iterations 
MCMCmetrop1R iteration 1 of 4000 
function value = -216.54581
theta = 
   1.94255
  -0.47988
Metropolis acceptance rate = 1.00000

MCMCmetrop1R iteration 1001 of 4000 
function value = -216.21549
theta = 
   1.81272
  -0.47418
Metropolis acceptance rate = 0.56643

MCMCmetrop1R iteration 2001 of 4000 
function value = -215.86791
theta = 
   1.85433
  -0.52118
Metropolis acceptance rate = 0.57221

MCMCmetrop1R iteration 3001 of 4000 
function value = -216.32347
theta = 
   1.93196
  -0.52205
Metropolis acceptance rate = 0.55948



@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
The Metropolis acceptance rate was 0.56875
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</code></pre>
</div>
<p>Revise los resultados.</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Revise la convergencia de las cadenas MCMC </span></span>
<span><span class="va">converg_diag_lnorm</span> <span class="op">&lt;-</span> <span class="fu">check_cdt_samples_convergence</span><span class="op">(</span><span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="va">converg_diag_lnorm</span></span>
<span></span>
<span></span>
<span><span class="co"># Guarde las muestras de MCMC en un dataframe</span></span>
<span><span class="va">si_samples_lnorm</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>type <span class="op">=</span> <span class="st">'Symptom onset'</span>,</span>
<span>meanlog <span class="op">=</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>,</span>
<span>sdlog <span class="op">=</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span>,</span>
<span>p50 <span class="op">=</span> <span class="fu">qlnorm</span><span class="op">(</span></span>
<span>p <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>meanlog <span class="op">=</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>, </span>
<span>sdlog <span class="op">=</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu">mutate</span><span class="op">(</span> <span class="co"># La ecuación para la conversión está aquí https://en.wikipedia.org/wiki/Log-normal_distribution</span></span>
<span>mean <span class="op">=</span> <span class="fu">exp</span><span class="op">(</span><span class="va">meanlog</span> <span class="op">+</span> <span class="op">(</span><span class="va">sdlog</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>sd <span class="op">=</span> <span class="fu">sqrt</span><span class="op">(</span><span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="va">sdlog</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu">exp</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">meanlog</span> <span class="op">+</span> <span class="va">sdlog</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Obtenga la media, desviación estándar e intervalo de credibilidad del 95% </span></span>
<span><span class="va">si_summary_lnorm</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">si_samples_lnorm</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>mean_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>mean_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>mean_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>sd_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>sd_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>sd_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">si_summary_lnorm</span></span>
<span></span>
<span><span class="co"># Obtenga las estadísticas reumen para los parámetros de la distribución</span></span>
<span><span class="va">si_samples_lnorm</span> <span class="op">|&gt;</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>meanlog_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">meanlog</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>meanlog_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">meanlog</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>meanlog_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">meanlog</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>sdlog_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sdlog</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>sdlog_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sdlog</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>sdlog_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sdlog</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">lognorm_meanlog</span> <span class="op">&lt;-</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'meanlog'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">lognorm_sdlog</span> <span class="op">&lt;-</span> <span class="va">si_fit_lnorm</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'sdlog'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="ajuste-de-una-distribución-weibull-para-el-intervalo-serial">8.2.4. Ajuste de una distribución Weibull para el intervalo
serial<a class="anchor" aria-label="anchor" href="#ajuste-de-una-distribuci%C3%B3n-weibull-para-el-intervalo-serial"></a>
</h4>
<p>Finalmente, ajuste de una distribución Weibull para los datos del
intervalo serial.</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We will run the model for 4000 iterations with the first 1000 samples discarded as burnin</span></span>
<span><span class="va">n_mcmc_samples</span> <span class="op">&lt;-</span> <span class="fl">3000</span> <span class="co"># number of samples to draw from the posterior (after the burnin)</span></span>
<span></span>
<span><span class="va">params</span> <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>dist <span class="op">=</span> <span class="st">"W"</span>, <span class="co"># Fitting a weibull distribution for the SI</span></span>
<span>method <span class="op">=</span> <span class="st">"MCMC"</span>, <span class="co"># MCMC using coarsedatatools</span></span>
<span>burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># number of burnin samples (samples discarded at the beginning of MCMC) </span></span>
<span>n1 <span class="op">=</span> <span class="fl">50</span>, <span class="co"># n1 is the number of pairs of mean and sd of the SI that are drawn</span></span>
<span>n2 <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="co"># n2 is the size of the posterior sample drawn for each pair of mean, sd of SI</span></span>
<span></span>
<span><span class="va">mcmc_control</span> <span class="op">&lt;-</span> <span class="fu">make_mcmc_control</span><span class="op">(</span></span>
<span>seed <span class="op">=</span> <span class="va">MCMC_seed</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">burnin</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">dist</span></span>
<span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">make_config</span><span class="op">(</span></span>
<span><span class="fu">list</span><span class="op">(</span></span>
<span>si_parametric_distr <span class="op">=</span> <span class="va">dist</span>,</span>
<span>mcmc_control <span class="op">=</span> <span class="va">mcmc_control</span>,</span>
<span>seed <span class="op">=</span> <span class="va">overall_seed</span>,</span>
<span>n1 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n1</span>,</span>
<span>n2 <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ajuste el intervalo serial </span></span>
<span><span class="va">si_fit_weibull</span> <span class="op">&lt;-</span> <span class="fu">coarseDataTools</span><span class="fu">::</span><span class="fu">dic.fit.mcmc</span><span class="op">(</span></span>
<span>dat <span class="op">=</span> <span class="va">si_data</span>,</span>
<span>dist <span class="op">=</span> <span class="va">dist</span>,</span>
<span>init.pars <span class="op">=</span> <span class="fu">init_mcmc_params</span><span class="op">(</span><span class="va">si_data</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>burnin <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">burnin</span>,</span>
<span>n.samples <span class="op">=</span> <span class="va">n_mcmc_samples</span>,</span>
<span>seed <span class="op">=</span> <span class="va">mcmc_control</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span></code></pre>
</div>
<p>Revise los resultados.</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Revise covengencia</span></span>
<span><span class="va">converg_diag_weibull</span> <span class="op">&lt;-</span> <span class="fu">check_cdt_samples_convergence</span><span class="op">(</span><span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Gelman-Rubin MCMC convergence diagnostic was successful.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">converg_diag_weibull</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb66">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Guarde las muestra MCMC en un dataframe</span></span>
<span><span class="va">si_samples_weibull</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>type <span class="op">=</span> <span class="st">'Symptom onset'</span>,</span>
<span>shape <span class="op">=</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>,</span>
<span>scale <span class="op">=</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span>,</span>
<span>p50 <span class="op">=</span> <span class="fu">qweibull</span><span class="op">(</span></span>
<span>p <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>shape <span class="op">=</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var1</span>, </span>
<span>scale <span class="op">=</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">samples</span><span class="op">$</span><span class="va">var2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu">mutate</span><span class="op">(</span> <span class="co"># La cuación para conversión está aquí https://en.wikipedia.org/wiki/Weibull_distribution</span></span>
<span>mean <span class="op">=</span> <span class="va">scale</span><span class="op">*</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">shape</span><span class="op">)</span>,</span>
<span>sd <span class="op">=</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">scale</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">2</span><span class="op">/</span><span class="va">shape</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="fu">gamma</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">shape</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Obtenga las estadísticas resumen</span></span>
<span><span class="va">si_summary_weibull</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">si_samples_weibull</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>mean_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>mean_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>mean_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>sd_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>sd_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>sd_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">sd</span>,probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">si_summary_weibull</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  mean_mean mean_l_ci mean_u_ci  sd_mean  sd_l_ci  sd_u_ci
1  7.692701  6.677548  8.809715 4.418743 3.797158 5.456492</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtenga las estadísticas resumen para los parámetros de la distribución.</span></span>
<span><span class="va">si_samples_weibull</span> <span class="op">|&gt;</span></span>
<span><span class="fu">summarise</span><span class="op">(</span></span>
<span>shape_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>shape_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>shape_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">shape</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span>,</span>
<span>scale_mean <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>scale_l_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>,</span>
<span>scale_u_ci <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">scale</span>, probs<span class="op">=</span><span class="fl">.975</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  shape_mean shape_l_ci shape_u_ci scale_mean scale_l_ci scale_u_ci
1   1.791214    1.50812   2.090071   8.631295   7.481234   9.943215</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weibull_shape</span> <span class="op">&lt;-</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'shape'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">weibull_scale</span> <span class="op">&lt;-</span> <span class="va">si_fit_weibull</span><span class="op">@</span><span class="va">ests</span><span class="op">[</span><span class="st">'scale'</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="grafique-los-resultados-para-el-intervalo-serial">8.2.5. Grafique los resultados para el intervalo serial<a class="anchor" aria-label="anchor" href="#grafique-los-resultados-para-el-intervalo-serial"></a>
</h4>
<p>Ahora, grafique el ajuste de las tres distribuciones. Asegúrese que
la distribución ajuste bien los datos del intervalo serial.</p>
<div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>data <span class="op">=</span> <span class="va">contacts</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">diff</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"#FFAD05"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">14</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">8</span>,<span class="fl">10</span>,<span class="fl">12</span>,<span class="fl">14</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    linewidth<span class="op">=</span><span class="fl">.8</span>,</span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span>, <span class="va">shape</span>, <span class="va">rate</span><span class="op">)</span><span class="op">(</span><span class="fu">dgamma</span><span class="op">(</span><span class="va">z</span>, <span class="va">shape</span>, <span class="va">rate</span><span class="op">)</span> <span class="op">*</span> <span class="fu">length</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    args <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>shape <span class="op">=</span> <span class="va">gamma_shape</span>, rate <span class="op">=</span> <span class="va">gamma_rate</span><span class="op">)</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>linetype  <span class="op">=</span> <span class="st">'Gamma'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    linewidth<span class="op">=</span><span class="fl">.8</span>,</span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span>, <span class="va">meanlog</span>, <span class="va">sdlog</span><span class="op">)</span><span class="op">(</span><span class="fu">dlnorm</span><span class="op">(</span><span class="va">z</span>, <span class="va">meanlog</span>, <span class="va">sdlog</span><span class="op">)</span> <span class="op">*</span> <span class="fu">length</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    args <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>meanlog <span class="op">=</span> <span class="va">lognorm_meanlog</span>, sdlog <span class="op">=</span> <span class="va">lognorm_sdlog</span><span class="op">)</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span><span class="st">'Log normal'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    linewidth<span class="op">=</span><span class="fl">.8</span>,</span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span>, <span class="va">shape</span>, <span class="va">scale</span><span class="op">)</span><span class="op">(</span><span class="fu">dweibull</span><span class="op">(</span><span class="va">z</span>, <span class="va">shape</span>, <span class="va">scale</span><span class="op">)</span> <span class="op">*</span> <span class="fu">length</span><span class="op">(</span><span class="va">contacts</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    args <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>shape <span class="op">=</span> <span class="va">weibull_shape</span>, scale <span class="op">=</span> <span class="va">weibull_scale</span><span class="op">)</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span><span class="st">'Weibull'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_linetype_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">'solid'</span>,<span class="st">'twodash'</span>,<span class="st">'dotted'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Days"</span>, y <span class="op">=</span> <span class="st">"Number of case pairs"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span><span class="fl">.2</span>,<span class="fl">5.2</span>,<span class="fl">.2</span>,<span class="fl">.2</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/EnfermedadX-rendered-plot%20dist-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Ahora calcule el WAIC y LOOIC. <code>coarseDataTools</code> no tiene
una forma integrada de hacer esto, por lo que se necesita calcular la
verosimilitud a partir de las cadenas MCMC y utilizar el paquete
<code>loo</code> en R.</p>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cargue las funciones de verosimilitud de coarseDataTools</span></span>
<span><span class="kw">source</span><span class="op">(</span><span class="st">"Functions/likelihood_function.R"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in file(filename, "r", encoding = encoding): cannot open file
'Functions/likelihood_function.R': No such file or directory</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in file(filename, "r", encoding = encoding): cannot open the connection</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb75">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_gamma</span> <span class="op">&lt;-</span> <span class="fu">calc_looic_waic</span><span class="op">(</span>symp <span class="op">=</span> <span class="va">si_data</span>, symp_si <span class="op">=</span> <span class="va">si_fit_gamma</span>, dist <span class="op">=</span> <span class="st">"G"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Relative effective sample sizes ('r_eff' argument) not specified.
For models fit with MCMC, the reported PSIS effective sample sizes and 
MCSE estimates will be over-optimistic.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb77">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_lnorm</span> <span class="op">&lt;-</span> <span class="fu">calc_looic_waic</span><span class="op">(</span>symp <span class="op">=</span> <span class="va">si_data</span>, symp_si <span class="op">=</span> <span class="va">si_fit_lnorm</span>, dist <span class="op">=</span> <span class="st">"L"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Relative effective sample sizes ('r_eff' argument) not specified.
For models fit with MCMC, the reported PSIS effective sample sizes and 
MCSE estimates will be over-optimistic.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Some Pareto k diagnostic values are slightly high. See help('pareto-k-diagnostic') for details.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb80">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_weibull</span> <span class="op">&lt;-</span> <span class="fu">calc_looic_waic</span><span class="op">(</span>symp <span class="op">=</span> <span class="va">si_data</span>, symp_si <span class="op">=</span> <span class="va">si_fit_weibull</span>, dist <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: 
2 (2.8%) p_waic estimates greater than 0.4. We recommend trying loo instead.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Relative effective sample sizes ('r_eff' argument) not specified.
For models fit with MCMC, the reported PSIS effective sample sizes and 
MCSE estimates will be over-optimistic.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb83">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Imprima resultados</span></span>
<span><span class="va">compare_gamma</span><span class="op">[[</span><span class="st">"waic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>             Estimate         SE
elpd_waic -202.009546  7.0118463
p_waic       1.936991  0.4409454
waic       404.019093 14.0236925</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb85">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_lnorm</span><span class="op">[[</span><span class="st">"waic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>             Estimate         SE
elpd_waic -202.215546  7.0178113
p_waic       1.874728  0.4106866
waic       404.431092 14.0356226</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb87">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_weibull</span><span class="op">[[</span><span class="st">"waic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>             Estimate         SE
elpd_waic -203.941362  6.9020056
p_waic       2.083623  0.6633186
waic       407.882723 13.8040112</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb89">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_gamma</span><span class="op">[[</span><span class="st">"looic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            Estimate         SE
elpd_loo -202.015856  7.0144149
p_loo       1.943301  0.4437589
looic     404.031713 14.0288297</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb91">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_lnorm</span><span class="op">[[</span><span class="st">"looic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            Estimate         SE
elpd_loo -202.218954  7.0182826
p_loo       1.878136  0.4114664
looic     404.437909 14.0365651</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb93">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_weibull</span><span class="op">[[</span><span class="st">"looic"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            Estimate         SE
elpd_loo -203.956018  6.9097884
p_loo       2.098279  0.6725387
looic     407.912036 13.8195768</code></pre>
</div>
<p>Incluya lo siguiente cuando reporte el intervalo serial:</p>
<ul>
<li><p>Media e intervalo de credibilidad del 95%</p></li>
<li><p>Desviación estándar y e intervalo de credibilidad del
95%</p></li>
<li><p>Los parámetros de la distribución ajustada (e.g., shape y scale
para distribución gamma)</p></li>
</ul>
<div class="alert alert-secondary">
<p><em>💡 <strong>Preguntas (7)</strong></em></p>
<ul>
<li>¿Qué distribución tiene el menor WAIC y LOOIC??</li>
</ul>
</div>
<div class="codewrapper sourceCode" id="cb95">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_summary_gamma</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  mean_mean mean_l_ci mean_u_ci  sd_mean  sd_l_ci  sd_u_ci
1  7.659641   6.65395  8.707372 4.342087 3.602425 5.481316</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb97">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_summary_lnorm</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  mean_mean mean_l_ci mean_u_ci  sd_mean  sd_l_ci  sd_u_ci
1  7.780719  6.692829  9.300588 5.189349 3.936678 7.289224</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb99">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_summary_weibull</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  mean_mean mean_l_ci mean_u_ci  sd_mean  sd_l_ci  sd_u_ci
1  7.692701  6.677548  8.809715 4.418743 3.797158 5.456492</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="pausa-3-_________">
<em><code>_______Pausa 3 _________</code></em><a class="anchor" aria-label="anchor" href="#pausa-3-_________"></a>
</h1>
<div class="section level2">
<h2 id="medidas-de-control">9. Medidas de control<a class="anchor" aria-label="anchor" href="#medidas-de-control"></a>
</h2>
<div class="section level3">
<h3 id="analicemos-el-resultado-juntos">9.1 Analicemos el resultado juntos<a class="anchor" aria-label="anchor" href="#analicemos-el-resultado-juntos"></a>
</h3>
<div class="alert alert-secondary">
<p>Ahora ha finalizado el análisis estadístico 🥳</p>
<ul>
<li><p>Compare el período de incubación y el intervalo serial.</p></li>
<li><p>¿Cuál es más largo?</p></li>
<li><p>¿Ocurre la transmisión pre-sintomática con la Enfermedad
X?</p></li>
</ul>
<!-- --><ul>
<li><p>¿Serán medidas efectivas aislar a los individuos sintomáticos y
rastrear y poner en cuarentena a sus contactos?</p></li>
<li><p>Si no lo son, ¿qué otras medidas se pueden implementar para
frenar el brote?</p></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="diseño-de-una-estrategía-de-rastreo-de-contactos">9.2 Diseño de una estrategía de rastreo de contactos<a class="anchor" aria-label="anchor" href="#dise%C3%B1o-de-una-estrateg%C3%ADa-de-rastreo-de-contactos"></a>
</h3>
<p>Basado en los rezagos estimados así como la demografía de los casos,
diseñe una estrategia de rastreo de contactos para el brote, incluyendo
un plan de comunicaciones (Pista: piense sobre la logística).</p>
</div>
</div>
<div class="section level2">
<h2 id="valores-verdaderos">10. Valores verdaderos<a class="anchor" aria-label="anchor" href="#valores-verdaderos"></a>
</h2>
<p>Los valores verdaderos usados para simular las epidemías fueron:</p>
<table style="width:96%;" class="table">
<caption>Tabla 2. Valores verdaderos del <strong><em>período de
incubación.</em></strong>
</caption>
<colgroup>
<col width="19%">
<col width="21%">
<col width="19%">
<col width="33%">
<col width="2%">
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td>Distribución</td>
<td colspan="3">Media (días) | Desviación estándar (días)</td>
</tr>
<tr class="even">
<td>Grupo 1</td>
<td>Log normal</td>
<td>5.7</td>
<td>4.6</td>
<td></td>
</tr>
<tr class="odd">
<td>Grupo 2</td>
<td>Weibull</td>
<td>7.1</td>
<td>3.7</td>
<td></td>
</tr>
</tbody>
</table>
<table style="width:96%;" class="table">
<caption>Tabla 3. Valores verdaderos del <strong><em>intervalo
serial</em></strong>.</caption>
<colgroup>
<col width="18%">
<col width="22%">
<col width="18%">
<col width="34%">
<col width="2%">
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td>Distribución</td>
<td colspan="3">Media (días) | Desviación estándar (días)</td>
</tr>
<tr class="even">
<td>Group 1</td>
<td>Gamma</td>
<td>8.4</td>
<td>4.9</td>
<td></td>
</tr>
<tr class="odd">
<td>Group 2</td>
<td>Gamma</td>
<td>4.8</td>
<td>3.3</td>
<td></td>
</tr>
</tbody>
</table>
<p>¿Cómo se comparan sus estimaciones con los valores verdaderos?
Discuta las posibles razones para las diferencias.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<p>Revise si al final de esta lección adquirió estas competencias:</p>
<ul>
<li><p>Comprender los conceptos clave de las distribuciones de retrasos
epidemiológicos para la Enfermedad X.</p></li>
<li><p>Entender las estructuras de datos y las herramientas para el
análisis de datos de rastreo de contactos.</p></li>
<li><p>Aprender cómo ajustar las estimaciones del intervalo serial y del
período de incubación de la Enfermedad X teniendo en cuenta la censura
por intervalo usando un marco de trabajo Bayesiano.</p></li>
<li><p>Aprender a utilizar estos parámetros para informar estrategias de
control en un brote de un patógeno desconocido.</p></li>
</ul>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="recursos-adicionales">11. Recursos adicionales<a class="anchor" aria-label="anchor" href="#recursos-adicionales"></a>
</h2>
<p>En este práctica, en gran medida se ignoraron los sesgos de
truncamiento a la derecha y sesgo dinámico, en parte debido a la falta
de herramientas fácilmente disponibles que implementen las mejores
prácticas. Para aprender más sobre cómo estos sesgos podrían afectar la
estimación de las distribuciones de retraso epidemiológico en tiempo
real, recomendamos un tutorial sobre el paquete
<code>dynamicaltruncation</code> en R de Sam Abbott y Sang Woo Park (<a href="https://github.com/parksw3/epidist-paper" class="external-link uri">https://github.com/parksw3/epidist-paper</a>).</p>
</div>
<div class="section level2">
<h2 id="contribuidores">12. Contribuidores<a class="anchor" aria-label="anchor" href="#contribuidores"></a>
</h2>
<p>Kelly Charniga, Zachary Madewell, Zulma M. Cucunubá</p>
</div>
<div class="section level2">
<h2 id="referencias">13. Referencias<a class="anchor" aria-label="anchor" href="#referencias"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Reich NG et al. Estimating incubation period distributions with
coarse data. Stat Med. 2009;28:2769–84. PubMed <a href="https://doi.org/10.1002/sim.3659" class="external-link uri">https://doi.org/10.1002/sim.3659</a>
</li>
<li>Miura F et al. Estimated incubation period for monkeypox cases
confirmed in the Netherlands, May 2022. Euro Surveill.
2022;27(24):pii=2200448. <a href="https://doi.org/10.2807/1560-7917.ES.2022.27.24.2200448" class="external-link uri">https://doi.org/10.2807/1560-7917.ES.2022.27.24.2200448</a>
</li>
<li>Abbott S, Park Sang W. Adjusting for common biases in infectious
disease data when estimating distributions. 2022 [cited 7 November
2023]. <a href="https://github.com/parksw3/dynamicaltruncation" class="external-link uri">https://github.com/parksw3/dynamicaltruncation</a>
</li>
<li>Lessler J et al. Incubation periods of acute respiratory viral
infections: a systematic review, The Lancet Infectious Diseases.
2009;9(5):291-300. <a href="https://doi.org/10.1016/S1473-3099(09)70069-6" class="external-link uri">https://doi.org/10.1016/S1473-3099(09)70069-6</a>.</li>
<li>Cori A et al. Estimate Time Varying Reproduction Numbers from
Epidemic Curves. 2022 [cited 7 November 2023]. <a href="https://github.com/mrc-ide/EpiEstim" class="external-link uri">https://github.com/mrc-ide/EpiEstim</a>
</li>
<li>Lambert B. A Student’s Guide to Bayesian Statistics. Los Angeles,
London, New Delhi, Singapore, Washington DC, Melbourne: SAGE, 2018.</li>
<li>Vehtari A et al. Rank-normalization, folding, and localization: An
improved R-hat for assessing convergence of MCMC. Bayesian Analysis
2021: Advance publication 1-28. <a href="https://doi.org/10.1214/20-BA1221" class="external-link uri">https://doi.org/10.1214/20-BA1221</a>
</li>
<li>Nishiura H et al. Serial interval of novel coronavirus (COVID-19)
infections. Int J Infect Dis. 2020;93:284-286. <a href="https://doi.org/10.1016/j.ijid.2020.02.060" class="external-link uri">https://doi.org/10.1016/j.ijid.2020.02.060</a>
</li>
</ol>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</div></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/Joskerus/Nuevoformato/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/Joskerus/Nuevoformato/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/Joskerus/Nuevoformato/" class="external-link">Source</a></p>
				<p><a href="https://github.com/Joskerus/Nuevoformato/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/epiverse-trace/sandpaper/tree/translate-spanish" class="external-link">sandpaper (0.15.0.9000)</a>,
        <a href="https://github.com/carpentries/pegboard/tree/1bc5753e917d515c3d888ce6cc013c0a680eacfc" class="external-link">pegboard (0.7.3)</a>,
      and <a href="https://github.com/epiverse-trace/varnish/tree/tracelactheme" class="external-link">varnish (0.3.3.9000)</a>.</p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://Joskerus.github.io/Nuevoformato/aio.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Todo en Una Sola Página",
  "creativeWorkStatus": "active",
  "url": "https://Joskerus.github.io/Nuevoformato/aio.html",
  "identifier": "https://Joskerus.github.io/Nuevoformato/aio.html",
  "dateCreated": "2023-11-10",
  "dateModified": "2023-12-03",
  "datePublished": "2023-12-03"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

